<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Metapopulasjoner - del 2</title>

  <meta property="description" itemprop="description" content="Vi er alle sammen individer i lag."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2023-08-07"/>
  <meta property="article:created" itemprop="dateCreated" content="2023-08-07"/>
  <meta name="article:author" content="Endre Grüner Ofstad"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Metapopulasjoner - del 2"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Vi er alle sammen individer i lag."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Metapopulasjoner - del 2"/>
  <meta property="twitter:description" content="Vi er alle sammen individer i lag."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Some demographic and genetic consequences of environmental heterogeneity for biological control;citation_publication_date=1969;citation_publisher=Oxford University Press;citation_volume=15;citation_author=Richard Levins"/>
  <meta name="citation_reference" content="citation_title=Community equilibria and stability, and an extension of the competitive exclusion principle;citation_publication_date=1970;citation_publisher=University of Chicago Press;citation_volume=104;citation_author=Simon A Levin"/>
  <meta name="citation_reference" content="citation_title=Using metapopulation theory for practical conservation of mangrove endemic birds;citation_publication_date=2020;citation_publisher=Wiley Online Library;citation_volume=34;citation_author=Ryan Huang;citation_author=Stuart L Pimm;citation_author=Chandra Giri"/>
  <meta name="citation_reference" content="citation_title=Estimating extinction risk with metapopulation models of large-scale fragmentation;citation_publication_date=2013;citation_publisher=Wiley Online Library;citation_volume=27;citation_author=Jessica K Schnell;citation_author=Grant M Harris;citation_author=Stuart L Pimm;citation_author=Gareth J Russell"/>
  <meta name="citation_reference" content="citation_title=Quantitative analysis of forest fragmentation in the atlantic forest reveals more threatened bird species than the current red list;citation_publication_date=2013;citation_publisher=Public Library of Science San Francisco, USA;citation_volume=8;citation_author=Jessica K Schnell;citation_author=Grant M Harris;citation_author=Stuart L Pimm;citation_author=Gareth J Russell"/>
  <meta name="citation_reference" content="citation_title=Long-term persistence of species and the SLOSS problem;citation_publication_date=2002;citation_publisher=Elsevier;citation_volume=218;citation_author=Otso Ovaskainen"/>
  <meta name="citation_reference" content="citation_title=Minimum viable metapopulation size, extinction debt, and the conservation of a declining species;citation_publication_date=2007;citation_publisher=Wiley Online Library;citation_volume=17;citation_author=Caroline R Bulman;citation_author=Robert J Wilson;citation_author=Alison R Holt;citation_author=Lucı́a Gálvez Bravo;citation_author=Regan I Early;citation_author=Martin S Warren;citation_author=Chris D Thomas"/>
  <meta name="citation_reference" content="citation_title=Metapopulation dynamics of a beetle species confined to burned forest sites in a managed forest region;citation_publication_date=2014;citation_publisher=Wiley Online Library;citation_volume=37;citation_author=Thomas Ranius;citation_author=Petter Bohman;citation_author=Olof Hedgren;citation_author=Lars-Ove Wikars;citation_author=Alexandro Caruso"/>
  <meta name="citation_reference" content="citation_title=Metapopulations revisited: The area-dependence of dispersal matters;citation_publication_date=2019;citation_publisher=Wiley Online Library;citation_volume=100;citation_author=Shaopeng Wang;citation_author=Florian Altermatt"/>
  <meta name="citation_reference" content="citation_title=Extinction dynamics in experimental metapopulations;citation_publication_date=2005;citation_publisher=National Acad Sciences;citation_volume=102;citation_author=Jane Molofsky;citation_author=Jean-Baptiste Ferdy"/>
  <meta name="citation_reference" content="citation_title=Intermediate disturbance in experimental landscapes improves persistence of beetle metapopulations;citation_publication_date=2015;citation_publisher=Wiley Online Library;citation_volume=96;citation_author=Byju N Govindan;citation_author=Zhilan Feng;citation_author=Yssa D DeWoody;citation_author=Robert K Swihart"/>
  <meta name="citation_reference" content="citation_title=Minimum viable metapopulation size, extinction debt, and the conservation of a declining species;citation_publication_date=2007;citation_publisher=Wiley Online Library;citation_volume=17;citation_author=Caroline R Bulman;citation_author=Robert J Wilson;citation_author=Alison R Holt;citation_author=Lucı́a Gálvez Bravo;citation_author=Regan I Early;citation_author=Martin S Warren;citation_author=Chris D Thomas"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","draft","author","bibliography","categories","output","date"]}},"value":[{"type":"character","attributes":{},"value":["Metapopulasjoner - del 2"]},{"type":"character","attributes":{},"value":["Vi er alle sammen individer i lag.\n"]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Endre Grüner Ofstad"]}]}]},{"type":"character","attributes":{},"value":["bibliography.bib"]},{"type":"character","attributes":{},"value":["Økologi","Økosystem","Arter","Dragehode","Dragehodeglansbille","Verneområde"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","code_folding","toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["08-07-2023"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bibliography.bib","gbif_data.csv","metapopulasjoner-del-2_files/anchor-4.2.2/anchor.min.js","metapopulasjoner-del-2_files/bowser-1.9.3/bowser.min.js","metapopulasjoner-del-2_files/crosstalk-1.2.0/css/crosstalk.min.css","metapopulasjoner-del-2_files/crosstalk-1.2.0/js/crosstalk.js","metapopulasjoner-del-2_files/crosstalk-1.2.0/js/crosstalk.js.map","metapopulasjoner-del-2_files/crosstalk-1.2.0/js/crosstalk.min.js","metapopulasjoner-del-2_files/crosstalk-1.2.0/js/crosstalk.min.js.map","metapopulasjoner-del-2_files/crosstalk-1.2.0/scss/crosstalk.scss","metapopulasjoner-del-2_files/distill-2.2.21/template.v2.js","metapopulasjoner-del-2_files/figure-html5/Analyse-1.png","metapopulasjoner-del-2_files/figure-html5/Analyse-2.png","metapopulasjoner-del-2_files/figure-html5/Analyse-3.png","metapopulasjoner-del-2_files/figure-html5/Analyse-4.png","metapopulasjoner-del-2_files/figure-html5/Analyse-5.png","metapopulasjoner-del-2_files/figure-html5/AndelBebodde-1.png","metapopulasjoner-del-2_files/figure-html5/AndelVekst-1.png","metapopulasjoner-del-2_files/figure-html5/Dragehode-1.png","metapopulasjoner-del-2_files/figure-html5/Dragehode-2.png","metapopulasjoner-del-2_files/figure-html5/Dragehode-3.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-1-1.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-1-2.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-1-3.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-1-4.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-2-1.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-2-2.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-2-3.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-2-4.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-3-1.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-3-2.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-3-3.png","metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-3-4.png","metapopulasjoner-del-2_files/header-attrs-2.14/header-attrs.js","metapopulasjoner-del-2_files/htmlwidgets-1.5.4/htmlwidgets.js","metapopulasjoner-del-2_files/ionicons-2.0.1/bootstrap-theme.min.css","metapopulasjoner-del-2_files/ionicons-2.0.1/bootstrap.min.css","metapopulasjoner-del-2_files/ionicons-2.0.1/bootstrap.min.js","metapopulasjoner-del-2_files/ionicons-2.0.1/font-awesome.min.css","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/fontawesome-webfont.eot","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/fontawesome-webfont.svg","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/fontawesome-webfont.ttf","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/fontawesome-webfont.woff","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/FontAwesome.otf","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/glyphicons-halflings-regular.eot","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/glyphicons-halflings-regular.svg","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/glyphicons-halflings-regular.ttf","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/glyphicons-halflings-regular.woff","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/ionicons.eot","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/ionicons.svg","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/ionicons.ttf","metapopulasjoner-del-2_files/ionicons-2.0.1/fonts/ionicons.woff","metapopulasjoner-del-2_files/ionicons-2.0.1/images/markers-matte.png","metapopulasjoner-del-2_files/ionicons-2.0.1/images/markers-matte@2x.png","metapopulasjoner-del-2_files/ionicons-2.0.1/images/markers-plain.png","metapopulasjoner-del-2_files/ionicons-2.0.1/images/markers-shadow.png","metapopulasjoner-del-2_files/ionicons-2.0.1/images/markers-shadow@2x.png","metapopulasjoner-del-2_files/ionicons-2.0.1/images/markers-soft.png","metapopulasjoner-del-2_files/ionicons-2.0.1/images/markers-soft@2x.png","metapopulasjoner-del-2_files/ionicons-2.0.1/ionicons.min.css","metapopulasjoner-del-2_files/ionicons-2.0.1/leaflet.awesome-markers.css","metapopulasjoner-del-2_files/ionicons-2.0.1/leaflet.awesome-markers.js","metapopulasjoner-del-2_files/ionicons-2.0.1/leaflet.awesome-markers.min.js","metapopulasjoner-del-2_files/ionrangeslider-css-2.3.1/css/ion.rangeSlider.css","metapopulasjoner-del-2_files/ionrangeslider-css-2.3.1/js/ion.rangeSlider.js","metapopulasjoner-del-2_files/ionrangeslider-css-2.3.1/js/ion.rangeSlider.min.js","metapopulasjoner-del-2_files/ionrangeslider-css-2.3.1/scss/_base.scss","metapopulasjoner-del-2_files/ionrangeslider-css-2.3.1/scss/_mixins.scss","metapopulasjoner-del-2_files/ionrangeslider-css-2.3.1/scss/shiny.scss","metapopulasjoner-del-2_files/ionrangeslider-javascript-2.3.1/css/ion.rangeSlider.css","metapopulasjoner-del-2_files/ionrangeslider-javascript-2.3.1/js/ion.rangeSlider.js","metapopulasjoner-del-2_files/ionrangeslider-javascript-2.3.1/js/ion.rangeSlider.min.js","metapopulasjoner-del-2_files/ionrangeslider-javascript-2.3.1/scss/_base.scss","metapopulasjoner-del-2_files/ionrangeslider-javascript-2.3.1/scss/_mixins.scss","metapopulasjoner-del-2_files/ionrangeslider-javascript-2.3.1/scss/shiny.scss","metapopulasjoner-del-2_files/jquery-3.6.0/jquery-3.6.0.js","metapopulasjoner-del-2_files/jquery-3.6.0/jquery-3.6.0.min.js","metapopulasjoner-del-2_files/jquery-3.6.0/jquery-3.6.0.min.map","metapopulasjoner-del-2_files/leaflet-1.3.1/images/layers-2x.png","metapopulasjoner-del-2_files/leaflet-1.3.1/images/layers.png","metapopulasjoner-del-2_files/leaflet-1.3.1/images/marker-icon-2x.png","metapopulasjoner-del-2_files/leaflet-1.3.1/images/marker-icon.png","metapopulasjoner-del-2_files/leaflet-1.3.1/images/marker-shadow.png","metapopulasjoner-del-2_files/leaflet-1.3.1/leaflet.css","metapopulasjoner-del-2_files/leaflet-1.3.1/leaflet.js","metapopulasjoner-del-2_files/leaflet-binding-2.1.1/leaflet.js","metapopulasjoner-del-2_files/leaflet-binding-2.1.2/leaflet.js","metapopulasjoner-del-2_files/leaflet-easybutton-1.3.1/easy-button.css","metapopulasjoner-del-2_files/leaflet-easybutton-1.3.1/easy-button.js","metapopulasjoner-del-2_files/leaflet-easybutton-1.3.1/EasyButton-binding.js","metapopulasjoner-del-2_files/leaflet-easybutton-1.3.1/LICENSE","metapopulasjoner-del-2_files/leaflet-locationfilter2-0.1.1/img/filter-icon.png","metapopulasjoner-del-2_files/leaflet-locationfilter2-0.1.1/img/move-handle.png","metapopulasjoner-del-2_files/leaflet-locationfilter2-0.1.1/img/resize-handle.png","metapopulasjoner-del-2_files/leaflet-locationfilter2-0.1.1/locationfilter-bindings.js","metapopulasjoner-del-2_files/leaflet-locationfilter2-0.1.1/locationfilter.css","metapopulasjoner-del-2_files/leaflet-locationfilter2-0.1.1/locationfilter.js","metapopulasjoner-del-2_files/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js","metapopulasjoner-del-2_files/leaflet-markercluster-1.0.5/leaflet.markercluster.js","metapopulasjoner-del-2_files/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js","metapopulasjoner-del-2_files/leaflet-markercluster-1.0.5/MarkerCluster.css","metapopulasjoner-del-2_files/leaflet-markercluster-1.0.5/MarkerCluster.Default.css","metapopulasjoner-del-2_files/leaflet-markercluster-1.0.5/MIT-LICENCE.txt","metapopulasjoner-del-2_files/leaflet-markercluster-1.0.5/package.json","metapopulasjoner-del-2_files/leafletfix-1.0.0/leafletfix.css","metapopulasjoner-del-2_files/popper-2.6.0/popper.min.js","metapopulasjoner-del-2_files/proj4-2.6.2/proj4.min.js","metapopulasjoner-del-2_files/Proj4Leaflet-1.0.1/proj4leaflet.js","metapopulasjoner-del-2_files/rstudio_leaflet-1.3.1/images/1px.png","metapopulasjoner-del-2_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css","metapopulasjoner-del-2_files/strftime-0.9.2/strftime-min.js","metapopulasjoner-del-2_files/tippy-6.2.7/tippy-bundle.umd.min.js","metapopulasjoner-del-2_files/tippy-6.2.7/tippy-light-border.css","metapopulasjoner-del-2_files/tippy-6.2.7/tippy.css","metapopulasjoner-del-2_files/tippy-6.2.7/tippy.umd.min.js","metapopulasjoner-del-2_files/webcomponents-2.0.0/webcomponents.js","Verneomraader_centroider.csv"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="metapopulasjoner-del-2_files/header-attrs-2.14/header-attrs.js"></script>
  <script src="metapopulasjoner-del-2_files/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <script src="metapopulasjoner-del-2_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="metapopulasjoner-del-2_files/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
  <script src="metapopulasjoner-del-2_files/leaflet-1.3.1/leaflet.js"></script>
  <link href="metapopulasjoner-del-2_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
  <script src="metapopulasjoner-del-2_files/proj4-2.6.2/proj4.min.js"></script>
  <script src="metapopulasjoner-del-2_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
  <link href="metapopulasjoner-del-2_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
  <script src="metapopulasjoner-del-2_files/leaflet-binding-2.1.2/leaflet.js"></script>
  <link href="metapopulasjoner-del-2_files/leaflet-easybutton-1.3.1/easy-button.css" rel="stylesheet" />
  <script src="metapopulasjoner-del-2_files/leaflet-easybutton-1.3.1/easy-button.js"></script>
  <script src="metapopulasjoner-del-2_files/leaflet-easybutton-1.3.1/EasyButton-binding.js"></script>
  <link href="metapopulasjoner-del-2_files/leaflet-locationfilter2-0.1.1/locationfilter.css" rel="stylesheet" />
  <script src="metapopulasjoner-del-2_files/leaflet-locationfilter2-0.1.1/locationfilter.js"></script>
  <script src="metapopulasjoner-del-2_files/leaflet-locationfilter2-0.1.1/locationfilter-bindings.js"></script>
  <link href="metapopulasjoner-del-2_files/ionicons-2.0.1/ionicons.min.css" rel="stylesheet" />
  <link href="metapopulasjoner-del-2_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
  <script src="metapopulasjoner-del-2_files/crosstalk-1.2.0/js/crosstalk.min.js"></script>
  <script src="metapopulasjoner-del-2_files/popper-2.6.0/popper.min.js"></script>
  <link href="metapopulasjoner-del-2_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="metapopulasjoner-del-2_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="metapopulasjoner-del-2_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="metapopulasjoner-del-2_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="metapopulasjoner-del-2_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="metapopulasjoner-del-2_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="metapopulasjoner-del-2_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Metapopulasjoner - del 2","description":"Vi er alle sammen individer i lag.","authors":[{"author":"Endre Grüner Ofstad","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2023-08-07T00:00:00.000+02:00","citationText":"Ofstad, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Metapopulasjoner - del 2</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">Økologi</div>
<div class="dt-tag">Økosystem</div>
<div class="dt-tag">Arter</div>
<div class="dt-tag">Dragehode</div>
<div class="dt-tag">Dragehodeglansbille</div>
<div class="dt-tag">Verneområde</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Vi er alle sammen individer i lag.</p></p>
</div>

<div class="d-byline">
  Endre Grüner Ofstad  
  
<br/>08-07-2023
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#hvilke-områder-kan-gjøre-nettverket-sterkere">Hvilke områder kan gjøre nettverket sterkere?</a>
<ul>
<li><a href="#nye-verneområder">Nye verneområder</a></li>
</ul></li>
<li><a href="#hvilke-områder-er-viktige">Hvilke områder er viktige?</a>
<ul>
<li><a href="#dragehode-og-dragehodeglansbille">Dragehode og dragehodeglansbille</a></li>
</ul></li>
<li><a href="#forbehold">Forbehold</a></li>
</ul>
</nav>
</div>
<p>I en <a href="https://egodrive.github.io/posts/Metapopulasjoner/">metapopulasjon</a> så betyr det noe hvor bestandene er. Og hvilke som ligger hvor - ikke alle bestander er skapt like.</p>
<h1 id="hvilke-områder-kan-gjøre-nettverket-sterkere">Hvilke områder kan gjøre nettverket sterkere?</h1>
<p>I en tidligere post om <a href="https://egodrive.github.io/posts/Metapopulasjoner/">metapopulasjoner</a> skrev vi om hvordan konnektivitet (<span class="math inline">\(S_{i}\)</span>) i en metapopulasjon kan “enkelt” skildres basert på avstanden mellom delområdene (<span class="math inline">\(d_{ij}\)</span>) og størrelsen av delområdene (<span class="math inline">\(A_{i}A_{j}\)</span>). Større konnektivitet er ofte assosiert med høyere sannsynlighet for tilstedeværelse av en bestand (<span class="citation" data-cites="ranius2014metapopulation"><a href="#ref-ranius2014metapopulation" role="doc-biblioref">Ranius et al.</a> (<a href="#ref-ranius2014metapopulation" role="doc-biblioref">2014</a>)</span>). Endringene i andelen bebodde område (eller bestander), <span class="math inline">\(p\)</span>, kan beskrives med utvekslingene mellom områdene <span class="math inline">\(i\)</span> og <span class="math inline">\(j\)</span>: <span class="math inline">\(m_{ij} = e^{-\alpha d_{ij}}A_{i}A_{j}\)</span>.</p>
<p>Man kan beskrive bevegelsen mellom alle områdene (dvs. for hele metapopulasjonen) med en kvadratisk matrise <strong>M</strong> hvor lengden (og bredden) er lik antall områder og fyller den med verdiene <span class="math inline">\(m_{ij}\)</span>. For denne matrisen så finner vi eigenverdien <span class="math inline">\(\lambda_{M}\)</span>. <span class="math inline">\(\lambda_{M}\)</span> kalles også for <em>metapopulasjonens kapasitet</em>. Eigenverdien tilsvarer andel bebodde områder (<span class="math inline">\(h\)</span> i modellene til <span class="citation" data-cites="levins1969some"><a href="#ref-levins1969some" role="doc-biblioref">Levins</a> (<a href="#ref-levins1969some" role="doc-biblioref">1969</a>)</span>, <span class="citation" data-cites="levin1970community"><a href="#ref-levin1970community" role="doc-biblioref">Levin</a> (<a href="#ref-levin1970community" role="doc-biblioref">1970</a>)</span>; også tilsvarende <span class="math inline">\(p\)</span> i <a href="https://egodrive.github.io/posts/Metapopulasjoner/">likning 3 her</a>).</p>
<p>Parametrene som inngår i lambda M er teoretisk knyttet til bestandens overlevelse. Når <span class="math inline">\(\lambda_{M}&gt;E/C\)</span> så vil bestanden være levedyktig i det lange løp. <span class="math inline">\(C\)</span> - koloniseringsrate (hvor mange individ som forlater et områder i retning av alle andre områder). Noe som også er bekreftet eksperimentelt (<span class="citation" data-cites="molofsky2005extinction"><a href="#ref-molofsky2005extinction" role="doc-biblioref">Molofsky and Ferdy</a> (<a href="#ref-molofsky2005extinction" role="doc-biblioref">2005</a>)</span>, <span class="citation" data-cites="govindan2015intermediate"><a href="#ref-govindan2015intermediate" role="doc-biblioref">Govindan et al.</a> (<a href="#ref-govindan2015intermediate" role="doc-biblioref">2015</a>)</span>) og i felt (<span class="citation" data-cites="bulman2007minimum"><a href="#ref-bulman2007minimum" role="doc-biblioref">Bulman et al.</a> (<a href="#ref-bulman2007minimum" role="doc-biblioref">2007</a>)</span>).</p>
<p>Metapopulasjonskapasitet samsvarer i stor grad med rødlistevurderingene (<span class="citation" data-cites="schnell2013estimating"><a href="#ref-schnell2013estimating" role="doc-biblioref">Schnell et al.</a> (<a href="#ref-schnell2013estimating" role="doc-biblioref">2013a</a>)</span>, <span class="citation" data-cites="schnell2013quantitative"><a href="#ref-schnell2013quantitative" role="doc-biblioref">Schnell et al.</a> (<a href="#ref-schnell2013quantitative" role="doc-biblioref">2013b</a>)</span>, <span class="citation" data-cites="huang2020using"><a href="#ref-huang2020using" role="doc-biblioref">Huang, Pimm, and Giri</a> (<a href="#ref-huang2020using" role="doc-biblioref">2020</a>)</span>). IUCN har laget rammeverket for rødlistevurderingene som brukes både nasjonalt og internasjonalt. I dette rammeverket så blir bestander som er fordelt over flere små områder (‘several small’) vurdert til å være i en mer kritisk tilstand enn bestander som er samlet i færre større områder (‘single large’).</p>
<p>En av antagelsen ved modellen over er at spredning øker med arealet til bestanden. Dette medfører blant annet at en økning av arealet til en bestand sitt område øker metapopulasjonskapasiteten. Altså et stort område er bedre enn mange små. Men det er ikke alltid tilfelle at spredning øker med arealet (<span class="citation" data-cites="wang2019metapopulations"><a href="#ref-wang2019metapopulations" role="doc-biblioref">Wang and Altermatt</a> (<a href="#ref-wang2019metapopulations" role="doc-biblioref">2019</a>)</span>). Hos noen arter, slik som gresshoppen vortebiter kan antallet som sprer seg bli mindre med økende områdestørrelse. Hos slike arter anbefales at man forsøker å ivareta mange små habitat.</p>
<p>Slike forhold, og antagelsene om positive forhold mellom areal og immigrasjon og uttryddelsesrate kan bakes inn i forholdene gitt over (<span class="citation" data-cites="ovaskainen2002long"><a href="#ref-ovaskainen2002long" role="doc-biblioref">Ovaskainen</a> (<a href="#ref-ovaskainen2002long" role="doc-biblioref">2002</a>)</span>), ved at økende areal kan ha en negativ eller positiv effekt på <span class="math inline">\(m_i{ij}\)</span> ved å justere eksponenten <span class="math inline">\(\theta\)</span>.</p>
<p><span class="math inline">\(m_{ij} = e^{-\alpha d_{ij}}A_{i}^{\theta_{ex}+\theta_{im}}A_{j}^{\theta_{em}}\)</span>.</p>
<p>Men til å begynne med så forholder vi oss til det enkle (og forsåvidt mest utbredte) scenarioet om at økende areal av område øker spredning, øker overlevelse og immigrasjon. Vi simulerer først en rekke bestander basert på forholdene gitt i tidligere innlegg om <a href="https://egodrive.github.io/posts/Metapopulasjoner/">metapopulasjoner</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-datatable.com'>data.table</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>;<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span>;<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span>;<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>gridExtra</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>nSimulations</span> <span class='op'>=</span> <span class='fl'>50</span></span>
<span><span class='va'>ParameterSpace</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span>nIterations <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>nSimulations</span>,</span>
<span>                             <span class='co'>#RangeØyer = seq(40,60,length.out = 1),</span></span>
<span>                             RangeStartProp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.35</span>,<span class='fl'>.6</span>,length.out <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                             RangeLandskap <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>3.4</span>,<span class='fl'>3.7</span>,length.out <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                             RangeKonstantC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.24</span>,<span class='fl'>.75</span>,length.out <span class='op'>=</span>  <span class='fl'>1</span><span class='op'>)</span>,<span class='co'># .23-&gt;.24</span></span>
<span>                             RangeKonstantE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>60</span>,<span class='fl'>100</span>,length.out <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,<span class='co'># 325-&gt;320</span></span>
<span>                             eNoise <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,length.out <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/setorder.html'>setorder</a></span><span class='op'>(</span><span class='va'>ParameterSpace</span>, <span class='va'>nIterations</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>SnittPrevalens</span> <span class='op'>=</span> <span class='cn'>NA</span></span>
<span><span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>SdPrevalens</span> <span class='op'>=</span> <span class='cn'>NA</span></span>
<span><span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>MinPrevalens</span> <span class='op'>=</span> <span class='cn'>NA</span></span>
<span><span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>AndelUtvikling</span> <span class='op'>=</span> <span class='cn'>NA</span></span>
<span><span class='va'>iteration</span> <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='co'># lengde på tidsserie</span></span>
<span><span class='va'>tmax</span> <span class='op'>=</span> <span class='fl'>100</span></span>
<span><span class='va'>RangeØyer</span> <span class='op'>=</span> <span class='fl'>40</span></span>
<span><span class='va'>nØyer</span> <span class='op'>=</span> <span class='va'>RangeØyer</span> <span class='co'># ParameterSpace$RangeØyer[i] #i</span></span>
<span></span>
<span><span class='va'>TidsArray</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>tmax</span><span class='op'>*</span><span class='va'>nØyer</span><span class='op'>)</span>, </span>
<span>                  dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>tmax</span>, <span class='va'>nØyer</span>,  <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>ParameterSpace</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>TidsserieKoloniseringsrater</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>tmax</span><span class='op'>*</span><span class='va'>nØyer</span><span class='op'>)</span>, </span>
<span>                                    dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>tmax</span>, </span>
<span>                                            <span class='va'>nØyer</span>, </span>
<span>                                            <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>ParameterSpace</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>GeografiArray</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>3</span><span class='op'>*</span><span class='va'>nØyer</span><span class='op'>)</span>,</span>
<span>                      dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='va'>nØyer</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>ParameterSpace</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>ParameterSpace</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='co'>#print(paste(i , "av", nrow(ParameterSpace)))</span></span>
<span>  <span class='co'># Antall øyer/habitat i systemet</span></span>
<span>  </span>
<span>  <span class='va'>iteration</span> <span class='op'>&lt;-</span> <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>nIterations</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  </span>
<span>  <span class='va'>AntallBebodd</span> <span class='op'>=</span> <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>RangeStartProp</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>*</span><span class='va'>nØyer</span> <span class='co'>#i</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='va'>iteration</span><span class='op'>)</span> <span class='co'># slik at ulike miljøstøy-nivå vil testes på de samme øy-konfigurasjonene</span></span>
<span>  <span class='va'>Bebodd</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>nØyer</span>,<span class='va'>AntallBebodd</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>Tilstede</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>nØyer</span><span class='op'>)</span></span>
<span>  <span class='va'>Tilstede</span><span class='op'>[</span><span class='va'>Bebodd</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fl'>1</span></span>
<span>  </span>
<span>  <span class='va'>TidsserieTilstede</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='va'>nØyer</span><span class='op'>)</span>, <span class='va'>tmax</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='va'>nØyer</span><span class='op'>)</span></span>
<span>  <span class='va'>TidsserieTilstede</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>Tilstede</span></span>
<span>  </span>
<span>  <span class='va'>TidsArray</span><span class='op'>[</span><span class='fl'>1</span>,,<span class='va'>iteration</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>Tilstede</span></span>
<span>  <span class='va'>TidsserieKoloniseringsrater</span><span class='op'>[</span><span class='fl'>1</span>,,<span class='va'>iteration</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>Tilstede</span></span>
<span>  </span>
<span>  <span class='co'># tilfeldig plassering av øyene</span></span>
<span>  <span class='va'>ArenaStørrelse</span> <span class='op'>=</span> <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>RangeLandskap</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='va'>iteration</span><span class='op'>)</span> <span class='co'># slik at ulike miljøstøy-nivå vil testes på de samme øy-konfigurasjonene</span></span>
<span>  <span class='va'>xPos</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>nØyer</span>, min <span class='op'>=</span> <span class='fl'>0</span>, max <span class='op'>=</span> <span class='va'>ArenaStørrelse</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>iteration</span><span class='op'>)</span> <span class='co'># slik at ulike miljøstøy-nivå vil testes på de samme øy-konfigurasjonene</span></span>
<span>  <span class='va'>yPos</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>nØyer</span>, min <span class='op'>=</span> <span class='fl'>0</span>, max <span class='op'>=</span> <span class='va'>ArenaStørrelse</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'># Tilfeldig størrelse</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='va'>iteration</span><span class='op'>)</span> <span class='co'># slik at ulike miljøstøy-nivå vil testes på de samme øy-konfigurasjonene</span></span>
<span>  <span class='va'>ØyStr</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>nØyer</span>, meanlog <span class='op'>=</span> <span class='fl'>.1</span>, sdlog <span class='op'>=</span> <span class='fl'>.2</span><span class='op'>)</span> <span class='co'>#Ai</span></span>
<span>  </span>
<span>  <span class='va'>GeografiArray</span><span class='op'>[</span>,,<span class='va'>i</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>ØyStr</span>, <span class='va'>xPos</span>, <span class='va'>yPos</span><span class='op'>)</span></span>
<span>  <span class='co'># Regn ut mellom-øy avstand</span></span>
<span>  <span class='va'>MellomØyAvstand</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>xPos</span>, <span class='va'>yPos</span><span class='op'>)</span>, diag <span class='op'>=</span> <span class='cn'>T</span>, upper <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='co'># dij</span></span>
<span>  <span class='va'>Alpha</span> <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span><span class='co'>#1/mean(MellomØyAvstand)</span></span>
<span>  <span class='co'># Konstanter</span></span>
<span>  <span class='va'>c_konstant</span> <span class='op'>=</span> <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>RangeKonstantC</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='va'>e_konstant</span> <span class='op'>=</span> <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>RangeKonstantE</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  </span>
<span>  <span class='va'>eNoise</span> <span class='op'>=</span> <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>eNoise</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='co'># Utryddelsesrater er konstant over tid</span></span>
<span>  <span class='va'>UtryddelsesRateØy_i</span> <span class='op'>=</span> <span class='va'>e_konstant</span><span class='op'>/</span><span class='va'>ØyStr</span></span>
<span>  </span>
<span>  <span class='co'># fra Hanski, Ilkka, et al. "The quantitative incidence function model and persistence of an endangered butterfly metapopulation." Conservation Biology 10.2 (1996): 578-590.</span></span>
<span>  <span class='co'># ØystrEffekt = 0.952</span></span>
<span>  <span class='co'># muTick = 0.158</span></span>
<span>  </span>
<span>  <span class='co'># AjAi = sapply(ØyStr, function(x) x*ØyStr)</span></span>
<span>  <span class='co'># mij = exp(-Alpha*as.matrix(MellomØyAvstand))*AjAi # number of immigrants</span></span>
<span>  </span>
<span>  <span class='co'># Tidssteg </span></span>
<span>  <span class='va'>t</span> <span class='op'>=</span> <span class='fl'>2</span></span>
<span>  <span class='va'>NoiseE</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>tmax</span>, sd <span class='op'>=</span> <span class='va'>eNoise</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='kw'>while</span><span class='op'>(</span><span class='va'>t</span><span class='op'>&lt;</span><span class='va'>tmax</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    </span>
<span>    <span class='va'>KoloniseringsRateØy_i</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>nØyer</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='va'>Aj</span> <span class='op'>=</span> <span class='va'>ØyStr</span><span class='op'>[</span><span class='op'>-</span><span class='va'>i</span><span class='op'>]</span></span>
<span>      <span class='va'>Aj</span> <span class='op'>=</span> <span class='va'>Aj</span> <span class='op'>+</span> <span class='va'>NoiseE</span><span class='op'>[</span><span class='va'>t</span><span class='op'>]</span></span>
<span>      <span class='va'>c_konstant</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Tilstede</span><span class='op'>[</span><span class='op'>-</span><span class='va'>i</span><span class='op'>]</span><span class='op'>*</span><span class='va'>Aj</span><span class='op'>*</span></span>
<span>                       <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Alpha</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>MellomØyAvstand</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='va'>i</span>,<span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span> <span class='co'># Si</span></span>
<span>    </span>
<span>    <span class='va'>TidsserieKoloniseringsrater</span><span class='op'>[</span><span class='va'>t</span>,,<span class='va'>i</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>KoloniseringsRateØy_i</span></span>
<span>    </span>
<span>    <span class='co'># Sannsynligheten for bebodd øy</span></span>
<span>    <span class='va'>Pi</span> <span class='op'>=</span> <span class='va'>KoloniseringsRateØy_i</span><span class='op'>/</span><span class='op'>(</span><span class='va'>KoloniseringsRateØy_i</span> <span class='op'>+</span> <span class='va'>UtryddelsesRateØy_i</span><span class='op'>)</span> <span class='co'># Også kjent som Ji</span></span>
<span>    <span class='va'>Pi</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Pi</span><span class='op'>&gt;</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Pi</span><span class='op'>&lt;</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='va'>Pi</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    </span>
<span>    <span class='va'>Kolonisert</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>Pi</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span>, <span class='fl'>1</span>, prob <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>x</span>,<span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    </span>
<span>    <span class='co'># Oppdater bebodd-status</span></span>
<span>    <span class='va'>Tilstede</span><span class='op'>&lt;-</span><span class='va'>Kolonisert</span></span>
<span>    <span class='va'>TidsserieTilstede</span><span class='op'>[</span><span class='va'>t</span>,<span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>Tilstede</span></span>
<span>    <span class='va'>TidsArray</span><span class='op'>[</span><span class='va'>t</span>,,<span class='va'>i</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>Tilstede</span></span>
<span>    </span>
<span>    <span class='co'># Oppdater tidssteg</span></span>
<span>    <span class='va'>t</span> <span class='op'>=</span> <span class='va'>t</span><span class='op'>+</span><span class='fl'>1</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>SnittPrevalens</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>TidsserieTilstede</span><span class='op'>)</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span></span>
<span>  <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>SdPrevalens</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>TidsserieTilstede</span><span class='op'>)</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span></span>
<span>  <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>MinPrevalens</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>TidsserieTilstede</span><span class='op'>)</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span></span>
<span>  <span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>AndelUtvikling</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>TidsserieTilstede</span><span class='op'>)</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>TidsserieTilstede</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>i</span><span class='op'>==</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>ParameterSpace</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>ParameterSpace <span class='op'>=</span> <span class='va'>ParameterSpace</span>,</span>
<span>                 Geografi <span class='op'>=</span> <span class='va'>GeografiArray</span>,</span>
<span>                 TidsArray <span class='op'>=</span> <span class='va'>TidsArray</span>,</span>
<span>                 TidsserieKoloniseringsrater <span class='op'>=</span> <span class='va'>TidsserieKoloniseringsrater</span><span class='op'>)</span>,</span>
<span>            <span class='st'>"ParameterSpace_MetaPopStoch.rds"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>p1</span> <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ParameterSpace</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>MinPrevalens</span>, x <span class='op'>=</span> <span class='va'>eNoise</span>, group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>eNoise</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>        axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Andel \n (minimum)"</span><span class='op'>)</span></span>
<span><span class='va'>p2</span> <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ParameterSpace</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>SnittPrevalens</span>, </span>
<span>                x <span class='op'>=</span> <span class='va'>eNoise</span>, group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>eNoise</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, </span>
<span>        axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Andel \n (gj.snitt)"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p3</span> <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ParameterSpace</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>AndelUtvikling</span><span class='op'>*</span><span class='fl'>200</span>, x <span class='op'>=</span> <span class='va'>eNoise</span>,</span>
<span>                group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>eNoise</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, linetype<span class='op'>=</span><span class='st'>"dashed"</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Andelsvekst\n per år x 200"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Miljøstokastisitet"</span><span class='op'>)</span><span class='co'>#+</span></span>
<span><span class='co'>#scale_y_continuous(breaks = seq(-.2,.2,.1))+coord_cartesian(ylim = c(-0.1,0.1))</span></span>
<span></span>
<span><span class='va'>Geografi</span> <span class='op'>=</span> <span class='va'>GeografiArray</span><span class='co'>#aa$Geografi</span></span>
<span><span class='va'>TidsArray</span> <span class='op'>=</span> <span class='va'>TidsArray</span><span class='co'>#aa$TidsArray</span></span>
<span><span class='va'>TidsserieKoloniseringsrater</span> <span class='op'>=</span> <span class='va'>TidsserieKoloniseringsrater</span><span class='co'>#aa$TidsserieKoloniseringsrater</span></span>
<span></span>
<span><span class='co'>#### Centrality ####</span></span>
<span><span class='co'># Eigenvector centrality er et mål på hvor mange noder som peker til deg. </span></span>
<span><span class='co'># Per parametersetting</span></span>
<span><span class='va'>Centrality</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>Geografi</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='co'># Per landskap</span></span>
<span>  <span class='va'>dij</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>Geografi</span><span class='op'>[</span><span class='fl'>2</span>,,<span class='va'>x</span><span class='op'>]</span>, <span class='va'>Geografi</span><span class='op'>[</span><span class='fl'>3</span>,,<span class='va'>x</span><span class='op'>]</span><span class='op'>)</span>, diag <span class='op'>=</span> <span class='cn'>T</span>, upper <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='va'>Centrality</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>dij</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='va'>js</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dij</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>dij</span><span class='op'>[</span><span class='va'>i</span>,<span class='va'>j</span><span class='op'>]</span><span class='op'>)</span><span class='op'>*</span><span class='va'>Geografi</span><span class='op'>[</span><span class='fl'>1</span>,<span class='va'>i</span>,<span class='va'>x</span><span class='op'>]</span><span class='op'>*</span><span class='va'>Geografi</span><span class='op'>[</span><span class='fl'>1</span>,<span class='va'>j</span>,<span class='va'>x</span><span class='op'>]</span></span>
<span>    <span class='op'>}</span><span class='op'>)</span></span>
<span>    <span class='va'>js</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>Centrality</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fl'>0</span> <span class='co'># set i = j &lt;- 0</span></span>
<span>  <span class='va'>Eigens</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>Centrality</span><span class='op'>)</span></span>
<span>  <span class='va'>EVec</span> <span class='op'>=</span> <span class='va'>Eigens</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>^</span><span class='fl'>2</span></span>
<span>  <span class='va'>EVec</span> <span class='op'>=</span> <span class='va'>EVec</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>EVec</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Eigenvector <span class='op'>=</span> <span class='va'>EVec</span>,</span>
<span>       EigenValue <span class='op'>=</span> <span class='va'>Eigens</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>EigenvalueCentrality</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>Centrality</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>EigenValue</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>## Connectivity ####</span></span>
<span><span class='va'>Alpha</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>1</span> <span class='co'># Alpha beskriver overlevelse for spredningen, dvs. 1/gjennomsnittlig spredningsdistanse</span></span>
<span><span class='co'># Per parametersetting</span></span>
<span><span class='va'>Connectivity</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>Geografi</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='co'># Per landskap</span></span>
<span>  <span class='va'>dij</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>Geografi</span><span class='op'>[</span><span class='fl'>2</span>,,<span class='va'>x</span><span class='op'>]</span>, <span class='va'>Geografi</span><span class='op'>[</span><span class='fl'>3</span>,,<span class='va'>x</span><span class='op'>]</span><span class='op'>)</span>, diag <span class='op'>=</span> <span class='cn'>T</span>, upper <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># Geographic aspect</span></span>
<span>  <span class='va'>Geo</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Alpha</span><span class='op'>*</span><span class='va'>dij</span><span class='op'>)</span><span class='op'>*</span><span class='va'>Geografi</span><span class='op'>[</span><span class='fl'>1</span>,,<span class='va'>x</span><span class='op'>]</span><span class='op'>*</span><span class='va'>dij</span> <span class='co'># ganger en siste med dij for å ignorer i = j, dvs. avstand med seg selv</span></span>
<span>  <span class='co'># Per tidssteg</span></span>
<span>  <span class='va'>Si_per_t</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>TidsArray</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>Tt</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'># per øy</span></span>
<span>    <span class='va'>Si</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>TidsArray</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>xx</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='va'>Si_x</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Alpha</span><span class='op'>*</span><span class='va'>TidsArray</span><span class='op'>[</span><span class='va'>Tt</span>,,<span class='va'>x</span><span class='op'>]</span><span class='op'>*</span><span class='va'>Geo</span><span class='op'>[</span><span class='va'>xx</span>,<span class='op'>]</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span><span class='op'>)</span></span>
<span>    <span class='va'>Si</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>Connectivities</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>Connectivity</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'>### Eksempel</span></span>
<span><span class='va'>df</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>Geografi</span><span class='op'>[</span>,,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Areal"</span>, <span class='st'>"xPos"</span>, <span class='st'>"yPos"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#df$Connectivity = colMeans(t(Connectivities))</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>Connectivity</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>Connectivities</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>EigenCentrality</span> <span class='op'>=</span> <span class='va'>Centrality</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>Eigenvector</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>Centrality</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>EigenValue</span></span>
<span></span>
<span><span class='va'>ParameterSpace</span> <span class='op'>=</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html'>as.data.table</a></span><span class='op'>(</span><span class='va'>ParameterSpace</span><span class='op'>)</span></span>
<span><span class='va'>ParameterSpace</span><span class='op'>[</span>,<span class='va'>AverageConnectivity</span><span class='op'>:=</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>Connectivities</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Øyer som har bedre tilknytning har bedre vekst</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ParameterSpace</span>,</span>
<span>       mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>(</span><span class='va'>EigenvalueCentrality</span><span class='op'>)</span>, </span>
<span>                     y <span class='op'>=</span> <span class='va'>AndelUtvikling</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, se<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Metapopulasjonkapasitet"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Vekst i andel\n bebodde områder"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>AndelUtvikling</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>,<span class='fl'>.9</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> </span></code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:AndelVekst"></span>
<img src="metapopulasjoner-del-2_files/figure-html5/AndelVekst-1.png" alt="Gjennomsnittlig vekst i andel bebodde områder med økende metapopulasjonskapasitet. Linjen viser en lineær regresjon. " width="624" />
<p class="caption">
Figure 1: Gjennomsnittlig vekst i andel bebodde områder med økende metapopulasjonskapasitet. Linjen viser en lineær regresjon.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ParameterSpace</span>,</span>
<span>       mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>(</span><span class='va'>EigenvalueCentrality</span><span class='op'>)</span>, </span>
<span>                     y <span class='op'>=</span> <span class='va'>SnittPrevalens</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"glm"</span>, </span>
<span>              method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>, </span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>"Metapopulasjonkapasitet"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>ylab</span><span class='op'>(</span><span class='st'>"Andel bebodde områder \n (gj.snitt)"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>coord_cartesian</span><span class='op'>(</span>ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>ParameterSpace</span><span class='op'>$</span><span class='va'>SnittPrevalens</span></span>
<span>                                  ,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>,<span class='fl'>.9</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> </span></code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:AndelBebodde"></span>
<img src="metapopulasjoner-del-2_files/figure-html5/AndelBebodde-1.png" alt="Gjennomsnittlig andel bebodde områder med økende metapopulasjonskapasitet. Linjen viser en logistisk regresjon." width="624" />
<p class="caption">
Figure 2: Gjennomsnittlig andel bebodde områder med økende metapopulasjonskapasitet. Linjen viser en logistisk regresjon.
</p>
</div>
</div>
<p>La oss nå se på et mer konkret eksempel.</p>
<h2 id="nye-verneområder">Nye verneområder</h2>
<p>Noen ganger har man mulighet til å utvide området man legger ned innsats i; ved å utvide skjøtselen til nye områder, ved å etablere nye verneområder mm.</p>
<p>Vi kan ta utgangspunkt i dagens verneområder i Rogaland fylke. Her er det meldt at fire nye områder <a href="https://www.statsforvalteren.no/nn/Rogaland/Miljo-og-klima/Verneomrade/oppstart-av-prosess-med-nye-verneomrader-i-rogaland/">kan være aktuelle for vern</a>.</p>
<p>Blant disse, av Klostervågen og Mosvatnet: hvilket område burde man velge?</p>
<p>Med metodikken over så kan vi første ta dagens situasjon med alle verneområder; hvor de ligger og hvor store de er. Man ender da opp med en metapopulasjonskapasitet <span class="math inline">\(\lambda_{M}\)</span> = 169.92, og ja legger man til både Klostervåen og Mosvatnet så blir dette best. Men, om man bare må velge et så kan det synes som at Klostervågen (<span class="math inline">\(\lambda_{M}\)</span> = 170.74) slår Mosvatnet (<span class="math inline">\(\lambda_{M}\)</span> = 170.12) såvidt. Eller, enhetene her er jo vanskelig å oversette uten mer kontekst. Så for alt vi vet så kan dette være en ganske stor forskjell.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-datatable.com'>data.table</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/dkahle/ggmap'>ggmap</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>mapproj</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>gridExtra</span><span class='op'>)</span></span>
<span><span class='va'>th</span> <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,axis.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/edzer/sp/'>sp</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>VO</span> <span class='op'>=</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/fread.html'>fread</a></span><span class='op'>(</span><span class='st'>"Verneomraader_centroider.csv"</span><span class='op'>)</span></span>
<span><span class='co'>#VO = VO[-1,]</span></span>
<span><span class='co'>#Mosvatnet</span></span>
<span><span class='co'>#531039,61; N: 6539879 Ø: 310963</span></span>
<span><span class='co'># Klostervågen</span></span>
<span><span class='co'>#847287,21; N: 6556056 Ø: 304732</span></span>
<span></span>
<span></span>
<span></span>
<span><span class='co'># Hettemåke foraging flight 4.6-11.8 km flight range # https://onlinelibrary.wiley.com/doi/full/10.1002/ece3.6291</span></span>
<span><span class='co'># sildemåke 30.9 #https://www.researchgate.net/publication/306119852_Terrestrial_and_Marine_Foraging_Strategies_of_an_Opportunistic_Seabird_Species_Breeding_in_the_Wadden_Sea/link/57b2ef8508aeaf239baefb27/download</span></span>
<span></span>
<span></span>
<span></span>
<span><span class='va'>Geografi</span> <span class='op'>=</span> <span class='va'>VOgeo</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>VO</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Areal"</span>, <span class='st'>"PosX"</span>, <span class='st'>"PosY"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>VOgeo1</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>VOgeo</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>847287.21</span>, <span class='fl'>304732</span>, <span class='fl'>6556056</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Klostervågen</span></span>
<span><span class='va'>VOgeo2</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>VOgeo</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>531039.61</span>, <span class='fl'>310963</span>, <span class='fl'>6539879</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Mosvatnet</span></span>
<span><span class='va'>VOgeo3</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>VOgeo2</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>847287.21</span>, <span class='fl'>304732</span>, <span class='fl'>6556056</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Begge to</span></span>
<span></span>
<span><span class='va'>Centrality</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>Geografi</span>, <span class='va'>DispersalDistance</span> <span class='op'>=</span> <span class='fl'>30.9</span>, <span class='va'>Alpha</span> <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>unit</span> <span class='op'>=</span> <span class='st'>"m"</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='co'># Geografi = dataramme med areal, x og y koordinate</span></span>
<span>  <span class='va'>Areal</span> <span class='op'>=</span> <span class='va'>Geografi</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span></span>
<span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>unit</span><span class='op'>==</span><span class='st'>"m"</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='va'>Areal</span> <span class='op'>=</span> <span class='va'>Areal</span><span class='op'>/</span><span class='fl'>1000000</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='va'>dij</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>Geografi</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span>, <span class='va'>Geografi</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>, diag <span class='op'>=</span> <span class='cn'>T</span>, upper <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>unit</span> <span class='op'>==</span> <span class='st'>"m"</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='va'>dij</span> <span class='op'>=</span> <span class='va'>dij</span><span class='op'>/</span><span class='fl'>1000</span><span class='co'># transform from meter to kilometer</span></span>
<span>    </span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  </span>
<span>  <span class='va'>Alpha</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>DispersalDistance</span></span>
<span>  </span>
<span>  <span class='va'>Si</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Geografi</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='va'>Geo</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Alpha</span><span class='op'>*</span><span class='va'>dij</span><span class='op'>[</span><span class='va'>i</span>,<span class='op'>-</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>*</span><span class='va'>Geografi</span><span class='op'>[</span><span class='op'>-</span><span class='va'>i</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> </span>
<span>  <span class='op'>}</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>M</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>Areal</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>Areal</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Alpha</span><span class='op'>*</span><span class='va'>dij</span><span class='op'>[</span><span class='va'>i</span>,<span class='va'>j</span><span class='op'>]</span><span class='op'>)</span><span class='op'>*</span><span class='va'>Areal</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>*</span><span class='va'>Areal</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span></span>
<span>    <span class='op'>}</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fl'>0</span></span>
<span>  <span class='va'>ev</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>)</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>^</span><span class='fl'>2</span></span>
<span>  <span class='va'>ev</span> <span class='op'>=</span> <span class='va'>ev</span><span class='op'>/</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='va'>we</span> <span class='op'>=</span> <span class='va'>ev</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>)</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span></span>
<span>  </span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Centrality <span class='op'>=</span> <span class='va'>Si</span>,</span>
<span>       EigenValue <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>)</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,</span>
<span>       Eigenvectors <span class='op'>=</span> <span class='va'>we</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>Measures</span> <span class='op'>=</span> <span class='fu'>Centrality</span><span class='op'>(</span>Geografi <span class='op'>=</span> <span class='va'>VOgeo</span><span class='op'>)</span></span>
<span><span class='va'>Plotting</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>Geografi</span> <span class='op'>=</span> <span class='va'>VOgeo3</span>, <span class='va'>AntallNye</span> <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='va'>InputData</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>Geografi</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>pp</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPoints</a></span><span class='op'>(</span>coords <span class='op'>=</span> <span class='va'>InputData</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_crs.html'>st_crs</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fl'>32632</span></span>
<span>  <span class='va'>bb</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>)</span></span>
<span>  <span class='va'>pp2</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_transform.html'>st_transform</a></span><span class='op'>(</span><span class='va'>pp</span>, <span class='fl'>4326</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>VOs</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_transform.html'>st_transform</a></span><span class='op'>(</span><span class='va'>pp</span>, <span class='fl'>4326</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>VOs</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PosX"</span>, <span class='st'>"PosY"</span><span class='op'>)</span></span>
<span>  <span class='va'>VOs</span><span class='op'>$</span><span class='va'>EV</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fu'>Centrality</span><span class='op'>(</span>Geografi <span class='op'>=</span> <span class='va'>InputData</span><span class='op'>)</span><span class='op'>$</span><span class='va'>Eigenvectors</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'>## Plot kartet</span></span>
<span>  <span class='va'>aaa</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/ggmap/man/get_map.html'>get_map</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>left <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>VOs</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>.2</span>, </span>
<span>                  right <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>VOs</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>.2</span>,</span>
<span>                  bottom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>VOs</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>.2</span>, </span>
<span>                  top <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>VOs</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>.2</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>Labs</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>VOs</span><span class='op'>$</span><span class='va'>PosY</span><span class='op'>)</span>,<span class='co'>#as.numeric(attr(aaa, "bb")[3]),</span></span>
<span>                    X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>VOs</span><span class='op'>$</span><span class='va'>PosX</span><span class='op'>)</span>,<span class='co'>#as.numeric(attr(aaa, "bb")[2]), </span></span>
<span>                    MC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Metapopulasjonskapasitet = "</span>,</span>
<span>                               <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'>Centrality</span><span class='op'>(</span>Geografi <span class='op'>=</span> </span>
<span>                                                  <span class='va'>InputData</span><span class='op'>)</span><span class='op'>$</span><span class='va'>EigenValue</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggmap/man/ggmap.html'>ggmap</a></span><span class='op'>(</span><span class='va'>aaa</span><span class='op'>)</span><span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Lengdegrad"</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Breddegrad"</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data<span class='op'>=</span> <span class='va'>VOs</span>, </span>
<span>               mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>PosX</span>, y <span class='op'>=</span> <span class='va'>PosY</span>,</span>
<span>                             size <span class='op'>=</span> <span class='va'>EV</span>, col <span class='op'>=</span> <span class='va'>EV</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>VOs</span>,<span class='va'>AntallNye</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>               mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>PosX</span>, y <span class='op'>=</span> <span class='va'>PosY</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_label</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>Labs</span>, </span>
<span>               mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>Y</span>, x <span class='op'>=</span> <span class='va'>X</span>,</span>
<span>                             label <span class='op'>=</span> <span class='va'>MC</span><span class='op'>)</span>,</span>
<span>               fontface <span class='op'>=</span> <span class='st'>"bold"</span>, fill <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='st'>"white"</span>,<span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>               hjust <span class='op'>=</span> <span class='fl'>0.05</span>, vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.7</span><span class='op'>)</span><span class='op'>+</span></span>
<span>    <span class='va'>th</span></span>
<span></span>
<span>  <span class='op'>}</span></span>
<span></span>
<span><span class='co'>#grid.arrange(</span></span>
<span>  <span class='fu'>Plotting</span><span class='op'>(</span><span class='va'>VOgeo</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span><span class='op'>)</span><span class='co'>#,</span></span></code></pre>
</div>
</details>
<img src="metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-1-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span>             <span class='fu'>Plotting</span><span class='op'>(</span><span class='va'>VOgeo1</span>, </span>
<span>                      AntallNye <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span><span class='op'>)</span><span class='co'>#,</span></span></code></pre>
</div>
</details>
<img src="metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-1-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span>             <span class='fu'>Plotting</span><span class='op'>(</span><span class='va'>VOgeo2</span>, </span>
<span>                      AntallNye <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span><span class='op'>)</span><span class='co'>#,</span></span></code></pre>
</div>
</details>
<img src="metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-1-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span>             <span class='fu'>Plotting</span><span class='op'>(</span><span class='va'>VOgeo3</span>, </span>
<span>                      AntallNye <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span><span class='op'>)</span><span class='co'>#, ncol = 4, nrow = 1)</span></span></code></pre>
</div>
</details>
<p><img src="metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-1-4.png" width="624" /></p>
</div>
<p>Det kan gi mening at Klostervågen er vurdert til bedre. Den økter “tettheten” av verneområder i et område med lavere tetthet enn omgivelsen til Mosvatnet. Men merk. Her så pøser vi jo inn bare areal på verneområdene. Hvor enunderliggende antagelse er at større område betyr bedre kvalitet. Areal er uten tvil viktig for kvaliteten til det enkelte området, men sammensetningen til området - hvilke naturtyper den består av - er også svært viktig (jf. <a href="https://egodrive.github.io/posts/Nisje/">nisje-konseptet</a>). Og fullstendig ignorert her.</p>
<h1 id="hvilke-områder-er-viktige">Hvilke områder er viktige?</h1>
<p>Om man nå har en rekke delområder som man skal skjøtte eller forvalte på noe vis, hvor skal man legge ned innsats?</p>
<p>Eigenverdien, <span class="math inline">\(\lambda_{M}\)</span>, til metapopulasjonen har en assosiert høyre eigenvektor. Denne har likt antall verdier (<span class="math inline">\(x\)</span>) som antall bestander i systemet, og kan brukes til å beskrive den enkelte bestanden sin betydning for metapopulasjonen sin kapasitet. Hvor hvert tall i eigenvektoren (<span class="math inline">\(x_{i}\)</span>, heretter kallt <span class="math inline">\(EV\)</span>) kvadrert og multiplisert med <span class="math inline">\(\lambda_{M}\)</span> vil gi dette målet; <span class="math inline">\(\lambda_{i} = \lambda_{M}EV^2\)</span>. Eigenvektoren til <span class="math inline">\(M\)</span>-matrisen er blitt brukt for å identifisere viktige områder for bevaring av fugler i den atlantiske regnskogen (<span class="citation" data-cites="huang2020using"><a href="#ref-huang2020using" role="doc-biblioref">Huang, Pimm, and Giri</a> (<a href="#ref-huang2020using" role="doc-biblioref">2020</a>)</span>).</p>
<p>I populasjonsøkologi tilsvarer vektoren den stabile aldersfordelingen om <span class="math inline">\(M\)</span>-matrisen var Leslie-matrisen til en bestand. Og kan tolkes likedan; over tid så vil verdiene i eigenvektorene reflektere hvor det befinner seg flest individer i bestanden. Og hvor man i populasjonsøkologi vil regne ut sensitivitet/elastisitet for å beregne hvilken parameter i Leslie-matrisen (f.eks. overlevelse eller fekunditet til en gitt aldersklasse) som er viktigst for bestandsveksten, så blir dette overflødig for <span class="math inline">\(M\)</span>-matrisen da den er symmetrisk. Dette betyr også at sensitivitet/elastisitet samsvarer med <span class="math inline">\(EV\)</span>. Kan også se til denne <a href="https://www.researchgate.net/profile/Selina-Heppell/publication/228579870_Life_Histories_and_Elasticity_Patterns_Perturbation_Analysis_for_Species_with_Minimal_Demographic_Data/links/5b76029692851ca65064e532/Life-Histories-and-Elasticity-Patterns-Perturbation-Analysis-for-Species-with-Minimal-Demographic-Data.pdf">studien</a> for beregning av sensitivitet/elastisitet.</p>
<h2 id="dragehode-og-dragehodeglansbille">Dragehode og dragehodeglansbille</h2>
<p>Dragehode er en <a href="https://artsdatabanken.no/Taxon/Dracocephalum_ruyschiana/102285">truet art</a>, som er vertsplante for den enda mer truede <a href="https://www.artsdatabanken.no/Taxon/Meligethes%20norvegicus/8060">dragehodeglansbillen</a>.</p>
<p>For disse artene så brukes det mye tid og penger på tiltak. Metapopulasjonsteori <em>kan</em> være en tilnærming på hvordan man skal prioritere <em>hvor</em> man bør gjøre tiltakene.</p>
<p>Vi henter data fra GBIF (Artskart) for disse to artene. Og antar at dragehodeglansbille har en gjennomsnittlig spredningsdistanse på ca. 1500 meter. Vi kjører først en algoritme som grupperer forekomstene slik at de som er innenfor 1500 m fra hverandre blir gruppert sammen og utgjør en “bestand.” Slik at bevelse innenfor denne avstanden er “normal” bevegelse, mens bevegelse utover dette er “spredning.”</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#install.packages("rgbif")</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/rgbif'>rgbif</a></span><span class='op'>)</span></span>
<span><span class='co'>#library(scrubr)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>maps</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-datatable.com'>data.table</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/edzer/sp/'>sp</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/raster'>raster</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>adehabitatHR</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>myspecies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Meligethes norvegicus"</span>,<span class='st'>"Dracocephalum ruyschiana"</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span><span class='op'>(</span><span class='st'>"C:/Users/endre/OneDrive/Tekster/egodrive.github.io/_posts/2022-10-01-metapopulasjoner-del-2/gbif_data.csv"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span><span class='va'>gbif_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/rgbif/reference/occ_data.html'>occ_data</a></span><span class='op'>(</span>scientificName <span class='op'>=</span> <span class='va'>myspecies</span>, </span>
<span>                      hasCoordinate <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                      country <span class='op'>=</span> <span class='st'>"NO"</span>, </span>
<span>                      limit <span class='op'>=</span> <span class='fl'>20000</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>Host</span> <span class='op'>=</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span> <span class='va'>gbif_data</span><span class='op'>$</span><span class='va'>`Dracocephalum ruyschiana`</span><span class='op'>$</span><span class='va'>data</span><span class='op'>)</span></span>
<span><span class='va'>Beetle</span> <span class='op'>=</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span><span class='va'>gbif_data</span><span class='op'>$</span><span class='va'>`Meligethes norvegicus`</span><span class='op'>$</span><span class='va'>data</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>Joint</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>Beetle</span>, <span class='va'>Host</span>, fill <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span></span>
<span><span class='va'>Joint</span><span class='op'>$</span><span class='va'>networkKeys</span><span class='op'>&lt;-</span><span class='cn'>NULL</span></span>
<span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/fwrite.html'>fwrite</a></span><span class='op'>(</span><span class='va'>Joint</span>,<span class='st'>"C:/Users/endre/OneDrive/Tekster/egodrive.github.io/_posts/2022-10-01-metapopulasjoner-del-2/gbif_data.csv"</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span><span class='va'>Joint</span> <span class='op'>=</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/fread.html'>fread</a></span><span class='op'>(</span><span class='st'>"C:/Users/endre/OneDrive/Tekster/egodrive.github.io/_posts/2022-10-01-metapopulasjoner-del-2/gbif_data.csv"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>Joint</span> <span class='op'>=</span> <span class='va'>Joint</span><span class='op'>[</span><span class='va'>decimalLatitude</span><span class='op'>&gt;</span><span class='fl'>58.5</span> <span class='op'>&amp;</span> <span class='va'>decimalLatitude</span><span class='op'>&lt;</span><span class='fl'>62</span><span class='op'>]</span></span>
<span></span>
<span><span class='va'>Joint</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/coordinates.html'>coordinates</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/spTransform.html'>spTransform</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPoints</a></span><span class='op'>(</span>coords <span class='op'>=</span> <span class='va'>Joint</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"decimalLongitude"</span>, <span class='st'>"decimalLatitude"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>                proj4string <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/sp/man/CRS-class.html'>CRS</a></span><span class='op'>(</span><span class='st'>"+init=epsg:4326"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/sp/man/CRS-class.html'>CRS</a></span><span class='op'>(</span><span class='st'>"+init=epsg:32632"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  , <span class='va'>Joint</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>Joint</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"UTMx"</span>, <span class='st'>"UTMy"</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class='va'>DispDistanceM</span> <span class='op'>=</span> <span class='fl'>1500</span></span>
<span></span>
<span><span class='co'># Create clusters, aka. populations</span></span>
<span><span class='va'>ssp</span> <span class='op'>=</span> <span class='va'>Joint</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span></span>
<span><span class='va'>chc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='va'>ssp</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>"complete"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Distance with a 1500 threshold  </span></span>
<span><span class='va'>chc.d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cutree.html'>cutree</a></span><span class='op'>(</span><span class='va'>chc</span>, h<span class='op'>=</span><span class='va'>DispDistanceM</span><span class='op'>)</span> </span>
<span><span class='va'>Joint</span><span class='op'>[</span>,<span class='va'>Populasjon</span><span class='op'>:=</span><span class='va'>chc.d</span><span class='op'>]</span></span>
<span></span>
<span><span class='co'># Lage et grid (kan brukes til å definere populasjon)</span></span>
<span><span class='co'>#Joint[,c("gridY", "gridX"):=list(cut(UTMy, seq(from = min(Joint$UTMy, na.rm = T),</span></span>
<span><span class='co'>#                                               to  = max(Joint$UTMy, na.rm = T),</span></span>
<span><span class='co'>#                                               by = DispDistanceM)),</span></span>
<span><span class='co'>#                                 cut(UTMx, seq(from = min(Joint$UTMx, na.rm = T),</span></span>
<span><span class='co'>#                                               to  = min(Joint$UTMx, na.rm = T),</span></span>
<span><span class='co'>#                                               by = DispDistanceM)))]</span></span>
<span><span class='co'># Finne sentrum hvor hver populasjon</span></span>
<span><span class='va'>Joint</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"centrY"</span>, <span class='st'>"centrX"</span><span class='op'>)</span><span class='op'>:=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>UTMy</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,</span>
<span>                                   <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>UTMx</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Populasjon"</span><span class='op'>)</span><span class='op'>]</span></span>
<span></span>
<span><span class='va'>Joint</span><span class='op'>[</span>,<span class='va'>Areal</span><span class='op'>:=</span><span class='op'>{</span><span class='kw'><a href='https://rdrr.io/r/base/try.html'>try</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/adehabitatHR/man/mcp.html'>mcp</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPoints</a></span><span class='op'>(</span><span class='va'>.SD</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"UTMx"</span>, <span class='st'>"UTMy"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>, percent <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span><span class='op'>$</span><span class='va'>area</span>,</span>
<span>                   silent <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>}</span>,</span>
<span>      <span class='st'>"Populasjon"</span><span class='op'>]</span></span>
<span><span class='va'>Joint</span><span class='op'>[</span>,<span class='va'>Areal</span><span class='op'>:=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Areal</span><span class='op'>)</span><span class='op'>|</span><span class='va'>Areal</span><span class='op'>==</span><span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>Joint</span><span class='op'>$</span><span class='va'>Areal</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,<span class='va'>Areal</span><span class='op'>)</span><span class='op'>]</span></span>
<span></span>
<span><span class='va'>Joint</span><span class='op'>[</span>,<span class='va'>nHost</span> <span class='op'>:=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>.SD</span><span class='op'>[</span><span class='va'>species</span><span class='op'>==</span><span class='st'>"Dracocephalum ruyschiana"</span><span class='op'>]</span><span class='op'>$</span><span class='va'>individualCount</span>,</span>
<span>                     na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Populasjon"</span><span class='op'>)</span><span class='op'>]</span></span>
<span><span class='va'>Joint</span><span class='op'>[</span>, <span class='va'>nHost</span><span class='op'>:=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>nHost</span><span class='op'>)</span>,<span class='fl'>.1</span>,<span class='va'>nHost</span><span class='op'>)</span><span class='op'>]</span></span>
<span><span class='va'>Joint</span><span class='op'>[</span>,<span class='va'>BeetlePresent</span><span class='op'>:=</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/duplicated.html'>uniqueN</a></span><span class='op'>(</span><span class='va'>species</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Populasjon"</span><span class='op'>)</span><span class='op'>]</span></span>
<span><span class='co'>#Joint[,BeetlePresent:=ifelse(BeetlePresent==1,"Ja","Nei")]</span></span>
<span></span>
<span><span class='kw'>if</span><span class='op'>(</span><span class='st'>"metapop"</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/utils/installed.packages.html'>installed.packages</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>metapop</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='kw'>else</span><span class='op'>{</span><span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"metapop"</span>, repos <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"http://R-Forge.R-project.org"</span>,</span>
<span>                                            <span class='st'>"http://your.nearest.CRAN.mirror.org"</span><span class='op'>)</span>, dep <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span><span class='va'>d</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='va'>Joint</span><span class='op'>[</span><span class='va'>centrY</span><span class='op'>&gt;</span><span class='fl'>0</span>,<span class='va'>.SD</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Populasjon"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"centrX"</span>, <span class='st'>"centrY"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>Ar</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Joint</span><span class='op'>[</span><span class='va'>centrY</span><span class='op'>&gt;</span><span class='fl'>0</span>,<span class='va'>.SD</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Populasjon"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>$</span><span class='va'>Areal</span><span class='op'>)</span></span>
<span><span class='va'>iD</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>DispDistanceM</span></span></code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-datatable.com'>data.table</a></span><span class='op'>)</span>;<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span>;<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>metapop</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>metacapa_2</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>d</span>, <span class='va'>A</span>, <span class='va'>alpha</span> <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>{</span></span>
<span> <span class='va'>M</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>alpha</span><span class='op'>*</span><span class='va'>d</span><span class='op'>)</span><span class='op'>)</span></span>
<span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>)</span><span class='op'>&lt;-</span> <span class='fl'>0</span></span>
<span> <span class='va'>M</span><span class='op'>&lt;-</span><span class='va'>M</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span><span class='op'>(</span><span class='va'>A</span>, <span class='va'>A</span><span class='op'>)</span></span>
<span> <span class='va'>tmp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>)</span></span>
<span> <span class='co'>#tmp2 &lt;- eigen(t(M))</span></span>
<span> </span>
<span> <span class='va'>ev</span> <span class='op'>&lt;-</span> <span class='va'>tmp</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span></span>
<span> </span>
<span> <span class='va'>eij</span> <span class='op'>=</span> <span class='op'>(</span><span class='va'>M</span><span class='op'>/</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>*</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>)</span><span class='op'>)</span></span>
<span> </span>
<span> </span>
<span> </span>
<span> <span class='va'>cap</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>capacity <span class='op'>=</span> <span class='va'>ev</span>, x <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>^</span><span class='fl'>2</span>, d <span class='op'>=</span> <span class='va'>d</span>, </span>
<span>             A <span class='op'>=</span> <span class='va'>A</span>, </span>
<span>             M <span class='op'>=</span> <span class='va'>M</span><span class='op'>)</span></span>
<span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>cap</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"metacapa"</span></span>
<span> <span class='va'>cap</span></span>
<span> <span class='op'>}</span></span>
<span></span>
<span><span class='va'>sol</span> <span class='op'>&lt;-</span> <span class='fu'>metacapa_2</span><span class='op'>(</span><span class='va'>d</span>, <span class='va'>Ar</span>,</span>
<span>                alpha <span class='op'>=</span> <span class='va'>iD</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>Joint</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>Joint</span><span class='op'>[</span><span class='va'>centrY</span><span class='op'>&gt;</span><span class='fl'>0</span>,<span class='va'>.SD</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Populasjon"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Populasjon"</span><span class='op'>)</span><span class='op'>]</span>,EV <span class='op'>=</span> <span class='va'>sol</span><span class='op'>$</span><span class='va'>x</span></span>
<span><span class='op'>)</span><span class='op'>[</span><span class='va'>Joint</span>, on <span class='op'>=</span> <span class='st'>"Populasjon"</span><span class='op'>]</span></span>
<span></span>
<span><span class='va'>p</span> <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>Joint</span><span class='op'>[</span><span class='va'>Areal</span><span class='op'>&gt;</span><span class='fl'>4</span> <span class='op'>&amp;</span> <span class='va'>nHost</span> <span class='op'>&gt;</span><span class='fl'>0.1</span><span class='op'>]</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span> y <span class='op'>=</span> <span class='op'>(</span><span class='va'>nHost</span><span class='op'>)</span>, x <span class='op'>=</span> <span class='op'>(</span><span class='va'>Areal</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>BeetlePresent</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='va'>EV</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"glm"</span>, </span>
<span>              method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"poisson"</span><span class='op'>)</span>, </span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html'>scale_color_discrete</a></span><span class='op'>(</span>name<span class='op'>=</span><span class='st'>"Dragehodeglansbille\ntilstede"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Areal (ha)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Dragehode (antall)"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position<span class='op'>=</span><span class='st'>"bottom"</span><span class='op'>)</span></span>
<span>  </span>
<span><span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks<span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/breaks_log.html'>log_breaks</a></span><span class='op'>(</span><span class='op'>)</span>,trans <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/log_trans.html'>log_trans</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks<span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/breaks_log.html'>log_breaks</a></span><span class='op'>(</span><span class='op'>)</span>,trans <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/log_trans.html'>log_trans</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-2-1.png" alt="Forholdet mellom antall dragehode i en bestand og areal på bestanden, hvor punktstørrelsen reflekterer EV (verdien bestanden har for metapopulasjonen av dragehode) og fargen om det er en bille tilstede eller ikke. Linjen viser en poisson-regresjon." width="624" />
<p class="caption">
Figure 3: Forholdet mellom antall dragehode i en bestand og areal på bestanden, hvor punktstørrelsen reflekterer EV (verdien bestanden har for metapopulasjonen av dragehode) og fargen om det er en bille tilstede eller ikke. Linjen viser en poisson-regresjon.
</p>
</div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>df</span> <span class='op'>=</span> <span class='va'>Joint</span><span class='op'>[</span><span class='va'>Areal</span><span class='op'>&gt;</span><span class='fl'>4</span> <span class='op'>&amp;</span> <span class='va'>nHost</span> <span class='op'>&gt;</span><span class='fl'>0.1</span><span class='op'>]</span><span class='op'>[</span>,<span class='va'>.SD</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='st'>"Populasjon"</span><span class='op'>]</span></span></code></pre>
</div>
</details>
</div>
<p>Man kan også se på <span class="math inline">\(EV\)</span> som en forklaring på om dragehodeglansbille er tilstede. Jo mer robust del av vertsbestanden man er i, jo mer sannsynlig vil det være å finne dragehodeglansbille. Det er forsåvidt en statistisk signifikant forhold, men merk: her har vi ikke gått dataene nærmere etter i sømene. Så dette “forholdet” må man ta med god klype salt (det er så mange bestander med, og det utvalget vi har er kanskje ikke samlet inn “godt nok”).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>BeetlePresent</span>, x <span class='op'>=</span> <span class='va'>EV</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"glm"</span>, </span>
<span>              method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>, </span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Bille tilstede"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="metapopulasjoner-del-2_files/figure-html5/unnamed-chunk-3-1.png" alt="Forholdet mellom hvorvidt dragehodeglansbille er tilstede og delområdet sin EV (rolle i metapopulasjonen) av dragehode." width="624" />
<p class="caption">
Figure 4: Forholdet mellom hvorvidt dragehodeglansbille er tilstede og delområdet sin EV (rolle i metapopulasjonen) av dragehode.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rstudio.github.io/leaflet/'>leaflet</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://leaflegend.roh.engineering'>leaflegend</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span> <span class='va'><a href='https://rstudio.github.io/crosstalk/'>crosstalk</a></span> <span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span> <span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span> <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>df</span> <span class='op'>=</span> <span class='va'>Joint</span><span class='op'>[</span>,<span class='fu'>.</span><span class='op'>(</span>lat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>decimalLatitude</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,</span>
<span>              long <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>decimalLongitude</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,</span>
<span>              BeetlePresent <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>BeetlePresent</span><span class='op'>)</span>, </span>
<span>              mag <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>EV</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Populasjon"</span><span class='op'>)</span><span class='op'>]</span></span>
<span></span>
<span><span class='va'>df</span> <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>lat</span><span class='op'>&gt;</span><span class='fl'>0</span> <span class='op'>&amp;</span> <span class='va'>df</span><span class='op'>$</span><span class='va'>long</span><span class='op'>&gt;</span><span class='fl'>0</span>,<span class='op'>]</span></span>
<span><span class='co'>#df$mag &lt;- (df$mag-min(df$mag, na.rm = T))/(max(df$mag, na.rm = T)-min(df$mag,na.rm = T))</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>mag</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/ecdf.html'>ecdf</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>mag</span><span class='op'>)</span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>mag</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># symbols &lt;- makeSymbolsSize(</span></span>
<span><span class='co'>#   values = df$mag,</span></span>
<span><span class='co'>#   shape = 'diamond',</span></span>
<span><span class='co'>#   #color = 'red',</span></span>
<span><span class='co'>#   color = ~pal(df$mag2), </span></span>
<span><span class='co'>#   #fillColor = 'red',</span></span>
<span><span class='co'>#   opacity = .5,</span></span>
<span><span class='co'>#   baseSize = 10</span></span>
<span><span class='co'># )</span></span>
<span></span>
<span></span>
<span><span class='co'># If you want to use predefined palettes in the RColorBrewer package:</span></span>
<span><span class='co'># Call RColorBrewer::display.brewer.all() to see all possible palettes</span></span>
<span><span class='va'>pal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/leaflet/man/colorNumeric.html'>colorNumeric</a></span><span class='op'>(</span></span>
<span>  palette <span class='op'>=</span> <span class='st'>'YlOrRd'</span>,</span>
<span>  domain <span class='op'>=</span> <span class='va'>df</span><span class='op'>$</span><span class='va'>mag2</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>mag2</span> <span class='op'>=</span> <span class='va'>df</span><span class='op'>$</span><span class='va'>mag</span></span>
<span><span class='va'>shared_data</span> <span class='op'>&lt;-</span> <span class='va'><a href='https://rdrr.io/pkg/crosstalk/man/SharedData.html'>SharedData</a></span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/crosstalk/man/filter_slider.html'>filter_slider</a></span><span class='op'>(</span><span class='st'>"mag"</span>, <span class='st'>"Metpop-verdi"</span>, <span class='va'>shared_data</span>, <span class='op'>~</span><span class='va'>mag2</span>, width <span class='op'>=</span> <span class='st'>"100%"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="form-group crosstalk-input crosstalk-input-slider js-range-slider" id="mag" style="width: 100%;">
<label class="control-label" for="mag">Metpop-verdi</label>
<input data-skin="shiny" data-type="double" data-min="0.229226361031519" data-max="1" data-from="0.229226361031519" data-to="1" data-step="0.01" data-grid="true" data-grid-num="9.63467048710602" data-grid-snap="false" data-prettify-separator="," data-keyboard="true" data-keyboard-step="1.29739776951673" data-drag-interval="true" data-data-type="number"/>
<script type="application/json" data-for="mag">{
  "values": [0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2292, 0.2321, 0.235, 0.2378, 0.2407, 0.2436, 0.2464, 0.2493, 0.2521, 0.255, 0.2579, 0.2607, 0.2636, 0.2665, 0.2693, 0.2722, 0.2751, 0.2779, 0.2808, 0.2837, 0.2865, 0.2894, 0.2923, 0.2951, 0.298, 0.3009, 0.3037, 0.3066, 0.3095, 0.3123, 0.3152, 0.3181, 0.3209, 0.3238, 0.3266, 0.3295, 0.3324, 0.3352, 0.3381, 0.341, 0.3438, 0.3467, 0.3496, 0.3524, 0.3553, 0.3582, 0.361, 0.3639, 0.3668, 0.3696, 0.3725, 0.3754, 0.3782, 0.3811, 0.384, 0.3868, 0.3897, 0.3926, 0.3954, 0.3983, 0.4011, 0.404, 0.4069, 0.4097, 0.4126, 0.4155, 0.4183, 0.4212, 0.4241, 0.4269, 0.4298, 0.4327, 0.4355, 0.4384, 0.4413, 0.4441, 0.447, 0.4499, 0.4527, 0.4556, 0.4585, 0.4613, 0.4642, 0.467, 0.4699, 0.4728, 0.4756, 0.4785, 0.4814, 0.4842, 0.4871, 0.49, 0.4928, 0.4957, 0.4986, 0.5014, 0.5043, 0.5072, 0.51, 0.5129, 0.5158, 0.5186, 0.5215, 0.5244, 0.5272, 0.5301, 0.533, 0.5358, 0.5387, 0.5415, 0.5444, 0.5473, 0.5501, 0.553, 0.5559, 0.5587, 0.5616, 0.5645, 0.5673, 0.5702, 0.5731, 0.5759, 0.5788, 0.5817, 0.5845, 0.5874, 0.5903, 0.5931, 0.596, 0.5989, 0.6017, 0.6046, 0.6074, 0.6103, 0.6132, 0.616, 0.6189, 0.6218, 0.6246, 0.6275, 0.6304, 0.6332, 0.6361, 0.639, 0.6418, 0.6447, 0.6476, 0.6504, 0.6533, 0.6562, 0.659, 0.6619, 0.6648, 0.6676, 0.6705, 0.6734, 0.6762, 0.6791, 0.6819, 0.6848, 0.6877, 0.6905, 0.6934, 0.6963, 0.6991, 0.702, 0.7049, 0.7077, 0.7106, 0.7135, 0.7163, 0.7192, 0.7221, 0.7249, 0.7278, 0.7307, 0.7335, 0.7364, 0.7393, 0.7421, 0.745, 0.7479, 0.7507, 0.7536, 0.7564, 0.7593, 0.7622, 0.765, 0.7679, 0.7708, 0.7736, 0.7765, 0.7794, 0.7822, 0.7851, 0.788, 0.7908, 0.7937, 0.7966, 0.7994, 0.8023, 0.8052, 0.808, 0.8109, 0.8138, 0.8166, 0.8195, 0.8223, 0.8252, 0.8281, 0.8309, 0.8338, 0.8367, 0.8395, 0.8424, 0.8453, 0.8481, 0.851, 0.8539, 0.8567, 0.8596, 0.8625, 0.8653, 0.8682, 0.8711, 0.8739, 0.8768, 0.8797, 0.8825, 0.8854, 0.8883, 0.8911, 0.894, 0.8968, 0.8997, 0.9026, 0.9054, 0.9083, 0.9112, 0.914, 0.9169, 0.9198, 0.9226, 0.9255, 0.9284, 0.9312, 0.9341, 0.937, 0.9398, 0.9427, 0.9456, 0.9484, 0.9513, 0.9542, 0.957, 0.9599, 0.9628, 0.9656, 0.9685, 0.9713, 0.9742, 0.9771, 0.9799, 0.9828, 0.9857, 0.9885, 0.9914, 0.9943, 0.9971, 1],
  "keys": ["269", "270", "271", "272", "273", "274", "275", "276", "277", "278", "279", "280", "281", "282", "283", "284", "285", "286", "287", "288", "289", "291", "292", "293", "294", "295", "296", "297", "298", "299", "300", "301", "302", "303", "304", "305", "306", "307", "308", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "337", "338", "339", "340", "341", "342", "343", "344", "345", "346", "347", "348", "349", "246", "159", "250", "236", "240", "195", "134", "231", "37", "196", "99", "164", "232", "245", "128", "133", "238", "212", "244", "38", "266", "261", "56", "230", "241", "202", "192", "173", "125", "251", "150", "123", "214", "264", "36", "206", "45", "163", "256", "51", "203", "151", "118", "94", "155", "129", "268", "101", "90", "223", "120", "265", "177", "205", "152", "235", "225", "216", "234", "33", "247", "121", "86", "89", "242", "213", "260", "96", "172", "182", "110", "255", "222", "248", "217", "258", "243", "228", "233", "208", "253", "263", "48", "267", "262", "188", "54", "148", "114", "259", "239", "39", "124", "252", "200", "211", "237", "254", "44", "41", "219", "227", "220", "180", "174", "226", "84", "47", "122", "184", "109", "111", "69", "158", "249", "183", "106", "105", "149", "108", "107", "104", "82", "35", "157", "92", "175", "27", "176", "171", "169", "93", "168", "178", "95", "161", "103", "189", "146", "167", "170", "165", "91", "229", "190", "210", "153", "127", "130", "85", "83", "132", "116", "131", "87", "43", "142", "117", "187", "140", "137", "28", "138", "143", "136", "144", "257", "141", "139", "40", "100", "102", "70", "52", "193", "218", "72", "4", "75", "76", "98", "73", "201", "61", "64", "160", "221", "49", "80", "74", "77", "181", "112", "65", "79", "34", "207", "191", "185", "199", "209", "53", "135", "78", "154", "71", "126", "97", "68", "31", "179", "58", "22", "215", "198", "81", "115", "60", "194", "6", "59", "13", "14", "46", "50", "18", "224", "147", "145", "16", "15", "63", "17", "156", "23", "66", "166", "197", "32", "9", "57", "186", "88", "10", "55", "162", "26", "29", "12", "19", "24", "290", "1", "30", "62", "67", "42", "204", "5", "20", "2", "21", "25", "11", "8", "113", "3", "7", "119"],
  "group": ["SharedDatad6dc8b42"]
}</script>
</div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/leaflet/man/leaflet.html'>leaflet</a></span><span class='op'>(</span><span class='va'>shared_data</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/leaflet/man/map-layers.html'>addTiles</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/leaflet/man/map-layers.html'>addCircleMarkers</a></span><span class='op'>(</span><span class='co'>#lng = ~lng, lat = ~lat</span></span>
<span>             , weight <span class='op'>=</span> <span class='fl'>1</span></span>
<span>             <span class='co'>#, shape = 'diamond'</span></span>
<span>             <span class='co'>#, opacity = 0.1</span></span>
<span>             , stroke <span class='op'>=</span> <span class='cn'>T</span></span>
<span>             <span class='co'>#, size = 10</span></span>
<span>             <span class='co'>#, radius = ~size</span></span>
<span>             , popup <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>mag</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>,<span class='st'>"-persentil"</span><span class='op'>)</span></span>
<span>             , color <span class='op'>=</span> <span class='op'>~</span><span class='fu'>pal</span><span class='op'>(</span><span class='va'>mag2</span><span class='op'>)</span></span>
<span>             , fillColor <span class='op'>=</span> <span class='op'>~</span><span class='fu'>pal</span><span class='op'>(</span><span class='va'>mag2</span><span class='op'>)</span></span>
<span>             <span class='co'>#, clusterOptions = markerClusterOptions()</span></span>
<span>             <span class='op'>)</span></span></code></pre>
</div>
</details>
<div id="htmlwidget-68a3104a86de0b24bff0" style="width:624px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-68a3104a86de0b24bff0">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addSelect","args":["SharedDatad6dc8b42"]},{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[59.8998048,59.8940263510638,59.8853124559129,60.4316718039216,59.832275375,59.5054528837209,59.860130494382,59.8545822839506,59.7334585952381,59.8892032978723,59.8698127777778,59.8890185135135,60.1229699193548,60.1078800642409,60.1393950882353,60.1431704770897,60.06720152,60.1678373923694,59.8944756127875,59.8889596052632,59.8733029019608,59.5036170857143,60.0626816,59.88302372,59.8625389661017,59.8654958390742,60.147904,60.7627173113867,59.891080892137,59.885785625,59.7197946648266,59.9318851818182,61.1636772727273,60.347841,61.0003564,61.146007,60.945472,61.114445,61.511966,60.7754953713525,59.889039,59.820565,60.888286375,61.5507101666667,61.774498048955,60.1297962686567,61.2873401904762,61.8698081666667,60.3910831538462,60.0771131538462,61.14492996,60.4551001428571,60.346786119222,60.0764346666667,59.8970215,60.867323,59.9463266470588,60.1819171333333,59.9401622222222,60.1787646666667,60.3701534090909,59.9037239565217,59.6918594705882,60.3421103333333,60.26375796,60.0257231875,59.877734,60.2665373684211,61.0696696923077,60.6267578181818,60.3106273333333,60.4384054,60.4038285384615,60.350565,60.3724202,60.4314707930284,60.3567889230769,60.3509738571429,60.3655298407156,60.3870265789474,59.5191892142857,61.2286446842105,60.8500685,61.2911173333333,60.8510499444444,61.0596066666667,60.8505893767832,59.8811878615385,61.56822596875,60.81327125,61.1068704615385,61.0230963043478,60.9933628333333,61.717718,60.9875191166667,61.304247,60.2745687894737,60.3109004285714,61.1575546086957,60.6780754444444,60.646833,60.6843765193421,60.9832462121212,61.0327055869565,61.0362795294118,61.0672948947368,61.0697244046751,61.0166438461538,61.105298,61.5302156363636,61.2907166,60.38327375,59.8654416533333,61.56516,59.5222844979069,60.9016090471365,60.8448489375,59.90286,59.8715301851852,61.8319608571429,61.7319596666667,61.227373,59.9985106666667,59.910405,59.664769,60.3109737777778,60.8051838333333,60.81491075,60.843691,60.9184663692905,60.8062309411765,60.8517772,60.91048025,60.8825515,60.3160717272727,60.8048673201448,60.81231825,60.7197460609053,60.7878785625,60.7894647372748,60.774071125,60.863448,60.7702869090909,60.7965321679262,60.1385763243243,61.1548309333333,60.1423241052632,60.801827,61.05756324447,59.752205,61.575963,61.870954625,60.7534003591511,60.327469625,59.0516415,60.0791131,61.2573659,61.2921003684211,60.927558,60.3755375,60.990022,59.8643308611096,59.993219,61.521761,61.0381591428571,59.7495417023363,60.9353425333333,61.0186162142857,61.0245359189189,60.937981125,61.005765,61.135723,61.04562,61.1316512222222,61.0463160714286,61.0381424864865,61.5728702,60.9855967272727,59.740940854259,61.0952475,60.3822874285714,61.059115,61.07814875,61.1092743333333,60.3632846666667,59.9112222,60.843687,60.6792525,61.1419801428571,60.9971203243109,60.304002,60.3067215,60.4631392222222,60.1994298,61.289935,60.30549625,59.9554314418204,59.7842182222222,60.3271323333333,60.6127715,60.3218405714286,60.6207785,61.096601,59.848722,59.935479,60.533064,60.3332826666667,61.326211875,60.324689,61.0245206022282,61.155582,60.337518,61.1502016666667,61.5496655,59.833408544167,61.4268587176446,61.1693360714286,60.3970928571429,60.8739874,61.1394254878049,60.3579465,60.291484,59.7266779780317,60.1294786666667,61.1680641428571,60.8621815,60.886154,60.895038,61.0604261666667,60.2815243333333,60.4012413333333,59.890169,61.661762,60.97747475,60.293048,61.645633,61.7015566666667,60.8244815,60.828013,61.1459708333333,61.1541126666667,61.54615,60.6494986666667,61.040676,59.998878,60.8959131526401,60.854647,60.979054,61.0708741666667,61.2045676666667,61.748719,61.8779354,61.83875,61.1550915,60.132216,60.865193,60.6499314221066,61.2208505,61.353056,59.90884725,61.317249,61.249105,61.5961,60.025662,59.7472,61.4667154549143,59.8395,61.5573473730599,60.8564482488601,60.6992712545102,61.3326551880231,59.535979,61.5361085651403,61.154862,61.5475095,60.66373,61.0181,60.9252655,61.3726,60.8220979254992,61.1986105,60.11514,59.6905415242564,60.0639296281416,60.0748,61.463287,61.106975,61.3641,59.97258,59.9099384615385,61.194023,61.2018,59.841204,59.9209,60.7867685,59.894,60.8040187838558,60.799204,61.109611,59.7183,59.718344,60.98132,61.583317,61.608096,60.9271,60.9263,60.0973,59.935714701784,59.7641,60.2455,59.92224,61.25685,61.3236,59.891278,59.8973,61.2762,61.0306,59.8674,59.9473,61.0872,59.9234,60.95088,60.846072,59.9356,61.2217,61.8772,60.790996288691,61.56336,61.3055204653904,60.0105,61.13415,61.26467,61.05606,61.70257,61.00232,59.3795,60.7915959576788,60.14972,61.32771,60.66907,61.002,59.93875,59.5981,60.32528,61.109643,60.094,60.7356,59.8982,61.7604],[10.6080932,10.6025009680851,10.5385816705259,10.4831681764706,10.496363525,10.6365026511628,10.5450626629213,10.5262677407407,10.5661283174603,10.7388958085106,10.5762363703704,10.6932031081081,10.305044983871,10.2724945400778,10.323400245098,10.3273143928061,10.27745924,10.3317410830704,10.7299774520866,10.6170205526316,10.5596805490196,10.6629705428571,10.3062784,10.71489816,10.5678379322034,10.7541314682687,11.158917,11.1352046104763,10.7624575124586,10.63238475,9.83248266839879,10.5716409090909,8.49739754545454,10.5262366956522,9.0789738,8.850427,10.7224665,8.598584,9.758275,10.8591088607605,10.581561,10.4872842857143,10.804283125,10.0035900555556,9.50789615350035,10.3225604029851,9.98593695238095,8.9943027,10.487566,10.2612827692308,8.56871072,10.8075425714286,10.4837608601835,10.2104333333333,10.684242125,8.510944,10.7517310588235,10.3249551333333,10.001045,10.3492535666667,10.5772979090909,10.6294135217391,10.7243274705882,10.46048825,10.48767784,10.6469993333333,10.614544,10.4568312105263,9.01683548076923,10.7630670909091,10.4230502222222,10.4954438,10.4833585384615,10.6020419166667,10.5432856,10.5029488197262,10.436148,10.5089405918367,10.525124160878,10.5037231578947,10.4701045714286,10.0822612105263,10.075291,9.95420016666667,9.99202955555556,9.39206566666667,9.95821813515308,10.7743390461538,9.6028754375,9.89523475,10.4634510769231,9.09572756521739,9.126312,9.43012166666667,9.16536131666667,10.270214,10.4678644736842,10.5786354285714,8.52126034782609,10.8761047777778,10.81334825,10.8642626025507,9.18630346212121,9.08066702173913,9.06654876470588,9.03222994736842,9.15948219875551,9.10515607692308,9.11203,10.1447707272727,10.3430013,10.536188225,10.5860299866667,9.955464,10.4457133964974,10.8712427710153,11.0261306875,10.77203,10.5349386666667,9.27552671428571,9.53828566666667,10.2444025,9.97009,10.27759975,10.790386,10.4881104444444,11.1281933333333,11.13069,10.75745,10.8988261101873,11.0939392352941,10.7816076,10.85984325,10.9688115,10.4720947272727,10.851740236964,10.7979255,11.0104459870189,10.8599733125,10.9130829084219,10.90535625,10.817508,10.8820551363636,10.9297796613727,10.3447790810811,10.419924,10.3041326842105,11.1533496666667,9.43556865574483,9.91404125,9.72586,9.0400705,11.5717984860104,10.500214,10.93596,10.2839486,10.4555563,10.3638085789474,9.4136335,10.5613743,9.25270516666667,10.7194055594299,10.624529,9.940568,10.4884397142857,10.8022736156544,9.39215506666667,9.22883621428571,9.2245974054054,9.3785869375,9.111131875,8.9147235,9.0601475,8.94373122222222,9.18951321428571,9.21232164864865,9.568542,9.13418727272727,9.86431719396488,8.9890765,10.4473034285714,9.0521615,8.997931375,8.9737145,10.4703071666667,10.7471914,10.1006556666667,10.915843,10.4690885714286,10.5909092440124,10.52049875,10.5517505,10.5047485555556,10.354467,10.316224,10.45140875,10.7987683281847,9.92108722222222,10.4772051666667,10.76969675,10.5178532857143,11.208136,10.433159,10.5404965,10.539969,10.201138,10.5306375,9.79435125,10.449752,10.5566746086925,9.0311885,10.595799,8.61393933333333,10.1158925,9.90973214215787,10.2282525031627,8.42960592857143,10.4623162857143,8.5468314,8.89227429268293,10.5827836666667,10.5537275,9.89944970680644,10.2836071666667,8.46945928571429,8.599978,8.4729908,9.593181,10.4005602777778,10.44134,10.51218,10.5131776666667,9.742426,9.20763375,10.5068805,9.722763,9.45935866666667,9.549633,9.52287,8.58594966666667,8.53638016666667,10.049893,10.9296613333333,10.521769,10.290839,10.646693654262,9.880246,9.392877,9.1418875,8.96143633333333,9.5569435,9.1456802,9.28585466666667,8.8225955,10.364767,8.5718465,11.1889035864259,10.1079785,9.73586766666667,10.656811,9.825764,10.057691,9.7723,10.67061,9.7562,10.2755555507809,10.5077,9.9749439489033,11.008256119849,8.91614261232624,10.3123812521514,10.4624885,9.3079194768794,10.35484,9.9176415,10.942784,9.2775,9.3089895,10.28905,11.0064048530855,8.5348805,10.349377,9.8956154827509,10.2118555822949,10.3387,10.219646,8.534705,10.053,10.72237,10.6821692307692,10.209223,10.1437666666667,10.44938,9.9658,10.878114,10.4566,10.9557492785803,10.817624,8.907234,10.04,10.064469,10.78957,9.909775,9.7474175,10.6926,10.8208,10.3397,10.6839580019868,10.7892,10.6862,10.50728,9.09393,10.2796,10.785311,10.555,10.1602,9.0398,10.7948,10.69165,8.9537,10.6278,9.95958,9.929229,10.7269,10.4496,9.1046,11.074411017934,10.29904,11.4538029168409,9.9954,10.39176,9.83971,8.90577,8.94506,9.2814,10.526,11.0377097504907,10.24722,10.51106,9.65721,11.11167,10.6554,11.0816,10.13214,8.999999,10.2137,11.2833,10.4836,9.4864],10,null,null,{"interactive":true,"className":"","stroke":true,"color":["#9D0026","#8E0026","#840026","#F54226","#920026","#CE0D22","#820026","#870026","#B40026","#AD0026","#890026","#A40026","#CC0B23","#CB0A23","#C20325","#C30425","#C00225","#C70824","#A20026","#900026","#8C0026","#D61220","#BD0026","#A00026","#8B0026","#A70026","#FD943F","#FD5C2D","#A60026","#9B0026","#DA151F","#B60026","#FEDD7F","#E7261E","#FE9941","#FFEC9E","#FFFAC0","#FFF4B2","#FEBC57","#FB4C29","#FEB34D","#950026","#FD6830","#FEB44E","#FFEB9C","#CA0A23","#FEAA49","#FFC762","#ED3422","#C90923","#FFE998","#F84727","#E31A1C","#FFC25D","#AB0026","#FFF3AE","#B30026","#D71320","#CD0C22","#D10F22","#F03923","#990026","#C10325","#EF3823","#E92A1F","#BC0026","#970026","#DB151F","#FEA546","#F84828","#DE171E","#F54326","#F23C24","#EC3121","#F44025","#F33F25","#EB2F20","#E0191D","#E8281F","#ED3221","#D31021","#FE9A41","#FD7133","#FEAB49","#FD7333","#FEDC7B","#FD6931","#AF0026","#FEDB7A","#FFE48D","#FD7F37","#FE9740","#FD903D","#FFE793","#FD8C3C","#FED875","#DC161E","#F23E24","#FFF9BE","#FA4B29","#FFE48E","#F94928","#FD893B","#FE9B42","#FE9F44","#FEA144","#FE9C42","#FE9D43","#FEA747","#FED571","#FEA647","#EA2C20","#850026","#FFC05B","#D20F21","#FD6D32","#FD642F","#FFE794","#800026","#FFE38A","#FEDC7D","#FEA948","#FFEEA2","#FEBB56","#FFEFA6","#DD171E","#FD7634","#FFF7B8","#FFE691","#FD7434","#FD6B31","#FD6F32","#FFF6B7","#FFFBC3","#E2191C","#FC552C","#FD5E2E","#FC592D","#FB4D2A","#FD602E","#FC4E2A","#FD6630","#FC572C","#FC532B","#C40524","#FD8639","#C50624","#FFC15C","#FE9E43","#FFEEA3","#FFE896","#FFE085","#FD7835","#DF181D","#FFE692","#BF0126","#FE9840","#FEA446","#FFFEC9","#EF3722","#FD8B3B","#A90026","#FFEA9B","#FFF9BC","#FD8138","#BA0026","#FD8439","#FD8F3D","#FD913E","#FD8238","#FD923E","#FED774","#FFF0A7","#FEAE4A","#FD953F","#FD933F","#FFE188","#FD8E3C","#D8141F","#FEAF4A","#EA2D20","#FED673","#FEA245","#FEA848","#E5201D","#B10026","#FD622F","#FFC35F","#FD873A","#FD7B36","#E6221D","#FFF1A9","#F74627","#CF0E22","#FFFCC4","#FFFABF","#B80026","#D41121","#E41E1D","#FEB953","#F13B24","#FFF1AA","#FFE997","#940026","#FFE187","#FFEC9D","#E7241E","#FFCA66","#E41C1C","#FD7A36","#FEB852","#FFF5B4","#FEDA78","#FFEDA1","#D51220","#FFDE82","#FED06C","#F64427","#FEB24C","#FEB04B","#EE3522","#FED26F","#FFE38C","#C60724","#FFDF83","#FEAD4A","#FEB14B","#FFCD69","#FD7D37","#FFF2AD","#FFFBC2","#FFF8BB","#FFCB67","#FFDE80","#FFE084","#FFFDC7","#FEB751","#FFF6B6","#FFBE58","#FFFCC5","#FFF2AB","#FEDA79","#FFCE6A","#FFF5B3","#FFF7BA","#FFFECB","#FEDD7E","#FED16E","#FEA345","#FFFDC8","#FFEFA5","#FEBA55","#FFC965","#FEB550","#FED470","#FFEA99","#FC512B","#FFCF6B","#FFBF5A","#FED976","#FFF3AF","#FFC560","#FFC864","#FFEDA0","#FFE289","#FFF4B1","#FFC661","#FFE58F","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#9E0026","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC"],"weight":1,"opacity":0.5,"fill":true,"fillColor":["#9D0026","#8E0026","#840026","#F54226","#920026","#CE0D22","#820026","#870026","#B40026","#AD0026","#890026","#A40026","#CC0B23","#CB0A23","#C20325","#C30425","#C00225","#C70824","#A20026","#900026","#8C0026","#D61220","#BD0026","#A00026","#8B0026","#A70026","#FD943F","#FD5C2D","#A60026","#9B0026","#DA151F","#B60026","#FEDD7F","#E7261E","#FE9941","#FFEC9E","#FFFAC0","#FFF4B2","#FEBC57","#FB4C29","#FEB34D","#950026","#FD6830","#FEB44E","#FFEB9C","#CA0A23","#FEAA49","#FFC762","#ED3422","#C90923","#FFE998","#F84727","#E31A1C","#FFC25D","#AB0026","#FFF3AE","#B30026","#D71320","#CD0C22","#D10F22","#F03923","#990026","#C10325","#EF3823","#E92A1F","#BC0026","#970026","#DB151F","#FEA546","#F84828","#DE171E","#F54326","#F23C24","#EC3121","#F44025","#F33F25","#EB2F20","#E0191D","#E8281F","#ED3221","#D31021","#FE9A41","#FD7133","#FEAB49","#FD7333","#FEDC7B","#FD6931","#AF0026","#FEDB7A","#FFE48D","#FD7F37","#FE9740","#FD903D","#FFE793","#FD8C3C","#FED875","#DC161E","#F23E24","#FFF9BE","#FA4B29","#FFE48E","#F94928","#FD893B","#FE9B42","#FE9F44","#FEA144","#FE9C42","#FE9D43","#FEA747","#FED571","#FEA647","#EA2C20","#850026","#FFC05B","#D20F21","#FD6D32","#FD642F","#FFE794","#800026","#FFE38A","#FEDC7D","#FEA948","#FFEEA2","#FEBB56","#FFEFA6","#DD171E","#FD7634","#FFF7B8","#FFE691","#FD7434","#FD6B31","#FD6F32","#FFF6B7","#FFFBC3","#E2191C","#FC552C","#FD5E2E","#FC592D","#FB4D2A","#FD602E","#FC4E2A","#FD6630","#FC572C","#FC532B","#C40524","#FD8639","#C50624","#FFC15C","#FE9E43","#FFEEA3","#FFE896","#FFE085","#FD7835","#DF181D","#FFE692","#BF0126","#FE9840","#FEA446","#FFFEC9","#EF3722","#FD8B3B","#A90026","#FFEA9B","#FFF9BC","#FD8138","#BA0026","#FD8439","#FD8F3D","#FD913E","#FD8238","#FD923E","#FED774","#FFF0A7","#FEAE4A","#FD953F","#FD933F","#FFE188","#FD8E3C","#D8141F","#FEAF4A","#EA2D20","#FED673","#FEA245","#FEA848","#E5201D","#B10026","#FD622F","#FFC35F","#FD873A","#FD7B36","#E6221D","#FFF1A9","#F74627","#CF0E22","#FFFCC4","#FFFABF","#B80026","#D41121","#E41E1D","#FEB953","#F13B24","#FFF1AA","#FFE997","#940026","#FFE187","#FFEC9D","#E7241E","#FFCA66","#E41C1C","#FD7A36","#FEB852","#FFF5B4","#FEDA78","#FFEDA1","#D51220","#FFDE82","#FED06C","#F64427","#FEB24C","#FEB04B","#EE3522","#FED26F","#FFE38C","#C60724","#FFDF83","#FEAD4A","#FEB14B","#FFCD69","#FD7D37","#FFF2AD","#FFFBC2","#FFF8BB","#FFCB67","#FFDE80","#FFE084","#FFFDC7","#FEB751","#FFF6B6","#FFBE58","#FFFCC5","#FFF2AB","#FEDA79","#FFCE6A","#FFF5B3","#FFF7BA","#FFFECB","#FEDD7E","#FED16E","#FEA345","#FFFDC8","#FFEFA5","#FEBA55","#FFC965","#FEB550","#FED470","#FFEA99","#FC512B","#FFCF6B","#FFBF5A","#FED976","#FFF3AF","#FFC560","#FFC864","#FFEDA0","#FFE289","#FFF4B1","#FFC661","#FFE58F","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#9E0026","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC","#FFFFCC"],"fillOpacity":0.2},null,null,["95-persentil","98-persentil","99-persentil","74-persentil","97-persentil","86-persentil","100-persentil","99-persentil","92-persentil","93-persentil","99-persentil","94-persentil","87-persentil","87-persentil","89-persentil","89-persentil","90-persentil","88-persentil","95-persentil","97-persentil","98-persentil","84-persentil","90-persentil","95-persentil","98-persentil","94-persentil","60-persentil","69-persentil","94-persentil","96-persentil","83-persentil","91-persentil","40-persentil","79-persentil","58-persentil","33-persentil","26-persentil","29-persentil","49-persentil","72-persentil","52-persentil","97-persentil","68-persentil","51-persentil","34-persentil","87-persentil","54-persentil","47-persentil","77-persentil","87-persentil","34-persentil","73-persentil","81-persentil","48-persentil","93-persentil","30-persentil","92-persentil","84-persentil","86-persentil","85-persentil","76-persentil","96-persentil","89-persentil","76-persentil","79-persentil","91-persentil","96-persentil","83-persentil","55-persentil","72-persentil","82-persentil","74-persentil","75-persentil","77-persentil","74-persentil","74-persentil","78-persentil","81-persentil","79-persentil","77-persentil","85-persentil","58-persentil","66-persentil","54-persentil","66-persentil","41-persentil","67-persentil","93-persentil","41-persentil","37-persentil","64-persentil","59-persentil","61-persentil","36-persentil","62-persentil","42-persentil","83-persentil","75-persentil","26-persentil","72-persentil","37-persentil","72-persentil","62-persentil","58-persentil","57-persentil","56-persentil","58-persentil","57-persentil","55-persentil","43-persentil","55-persentil","78-persentil","99-persentil","48-persentil","85-persentil","67-persentil","68-persentil","35-persentil","100-persentil","38-persentil","41-persentil","54-persentil","32-persentil","50-persentil","31-persentil","82-persentil","65-persentil","27-persentil","36-persentil","66-persentil","67-persentil","66-persentil","28-persentil","25-persentil","81-persentil","70-persentil","69-persentil","70-persentil","71-persentil","69-persentil","71-persentil","68-persentil","70-persentil","70-persentil","89-persentil","63-persentil","88-persentil","48-persentil","57-persentil","32-persentil","35-persentil","39-persentil","65-persentil","82-persentil","36-persentil","90-persentil","59-persentil","56-persentil","23-persentil","76-persentil","62-persentil","93-persentil","34-persentil","26-persentil","64-persentil","91-persentil","63-persentil","61-persentil","60-persentil","63-persentil","60-persentil","43-persentil","31-persentil","53-persentil","59-persentil","60-persentil","38-persentil","61-persentil","83-persentil","53-persentil","78-persentil","43-persentil","56-persentil","54-persentil","80-persentil","92-persentil","68-persentil","48-persentil","62-persentil","64-persentil","80-persentil","31-persentil","73-persentil","86-persentil","25-persentil","26-persentil","91-persentil","85-persentil","80-persentil","50-persentil","75-persentil","30-persentil","35-persentil","97-persentil","38-persentil","33-persentil","79-persentil","46-persentil","81-persentil","65-persentil","50-persentil","28-persentil","42-persentil","32-persentil","84-persentil","40-persentil","44-persentil","73-persentil","52-persentil","52-persentil","77-persentil","44-persentil","37-persentil","88-persentil","39-persentil","53-persentil","52-persentil","45-persentil","64-persentil","30-persentil","25-persentil","27-persentil","46-persentil","40-persentil","39-persentil","24-persentil","51-persentil","28-persentil","49-persentil","24-persentil","30-persentil","42-persentil","45-persentil","28-persentil","27-persentil","23-persentil","40-persentil","44-persentil","56-persentil","24-persentil","32-persentil","50-persentil","46-persentil","51-persentil","44-persentil","34-persentil","71-persentil","45-persentil","49-persentil","42-persentil","29-persentil","47-persentil","46-persentil","33-persentil","38-persentil","29-persentil","47-persentil","36-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","95-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil","23-persentil"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"ctKey":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349"],"ctGroup":"SharedDatad6dc8b42"}]}],"limits":{"lat":[59.0516415,61.8779354],"lng":[8.42960592857143,11.5717984860104]}},"evals":[],"jsHooks":[]}</script>
</div>
<h1 id="forbehold">Forbehold</h1>
<p>En (av kanskje flere) ting som ikke er nevnt i angående metapopulasjoner så langt. Bestandsdynamikk i den enkelte bestand.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-bulman2007minimum" class="csl-entry" role="doc-biblioentry">
Bulman, Caroline R, Robert J Wilson, Alison R Holt, Lucı́a Gálvez Bravo, Regan I Early, Martin S Warren, and Chris D Thomas. 2007. <span>“Minimum Viable Metapopulation Size, Extinction Debt, and the Conservation of a Declining Species.”</span> <em>Ecological Applications</em> 17 (5): 1460–73.
</div>
<div id="ref-govindan2015intermediate" class="csl-entry" role="doc-biblioentry">
Govindan, Byju N, Zhilan Feng, Yssa D DeWoody, and Robert K Swihart. 2015. <span>“Intermediate Disturbance in Experimental Landscapes Improves Persistence of Beetle Metapopulations.”</span> <em>Ecology</em> 96 (3): 728–36.
</div>
<div id="ref-huang2020using" class="csl-entry" role="doc-biblioentry">
Huang, Ryan, Stuart L Pimm, and Chandra Giri. 2020. <span>“Using Metapopulation Theory for Practical Conservation of Mangrove Endemic Birds.”</span> <em>Conservation Biology</em> 34 (1): 266–75.
</div>
<div id="ref-levin1970community" class="csl-entry" role="doc-biblioentry">
Levin, Simon A. 1970. <span>“Community Equilibria and Stability, and an Extension of the Competitive Exclusion Principle.”</span> <em>The American Naturalist</em> 104 (939): 413–23.
</div>
<div id="ref-levins1969some" class="csl-entry" role="doc-biblioentry">
Levins, Richard. 1969. <span>“Some Demographic and Genetic Consequences of Environmental Heterogeneity for Biological Control.”</span> <em>American Entomologist</em> 15 (3): 237–40.
</div>
<div id="ref-molofsky2005extinction" class="csl-entry" role="doc-biblioentry">
Molofsky, Jane, and Jean-Baptiste Ferdy. 2005. <span>“Extinction Dynamics in Experimental Metapopulations.”</span> <em>Proceedings of the National Academy of Sciences</em> 102 (10): 3726–31.
</div>
<div id="ref-ovaskainen2002long" class="csl-entry" role="doc-biblioentry">
Ovaskainen, Otso. 2002. <span>“Long-Term Persistence of Species and the SLOSS Problem.”</span> <em>Journal of Theoretical Biology</em> 218 (4): 419–33.
</div>
<div id="ref-ranius2014metapopulation" class="csl-entry" role="doc-biblioentry">
Ranius, Thomas, Petter Bohman, Olof Hedgren, Lars-Ove Wikars, and Alexandro Caruso. 2014. <span>“Metapopulation Dynamics of a Beetle Species Confined to Burned Forest Sites in a Managed Forest Region.”</span> <em>Ecography</em> 37 (8): 797–804.
</div>
<div id="ref-schnell2013estimating" class="csl-entry" role="doc-biblioentry">
Schnell, Jessica K, Grant M Harris, Stuart L Pimm, and Gareth J Russell. 2013a. <span>“Estimating Extinction Risk with Metapopulation Models of Large-Scale Fragmentation.”</span> <em>Conservation Biology</em> 27 (3): 520–30.
</div>
<div id="ref-schnell2013quantitative" class="csl-entry" role="doc-biblioentry">
———. 2013b. <span>“Quantitative Analysis of Forest Fragmentation in the Atlantic Forest Reveals More Threatened Bird Species Than the Current Red List.”</span> <em>PLoS One</em> 8 (5): e65357.
</div>
<div id="ref-wang2019metapopulations" class="csl-entry" role="doc-biblioentry">
Wang, Shaopeng, and Florian Altermatt. 2019. <span>“Metapopulations Revisited: The Area-Dependence of Dispersal Matters.”</span> <em>Ecology</em> 100 (9): e02792.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
